# Echo IM - ç®¡ç†åå°åŠŸèƒ½è§„åˆ’

**æ—¥æœŸ**: 2026-01-27  
**ç‰ˆæœ¬**: 1.0  
**æ ¸å¿ƒç†å¿µ**: æ§åˆ¶"æƒåŠ›è¾¹ç•Œ"ï¼Œä¸æ˜¯"åŠŸèƒ½ç»†èŠ‚"

---

## ğŸ¯ è®¾è®¡å“²å­¦

### åå°çš„èŒè´£

ç®¡ç†åå°å›ç­”ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š
1. **è°å¯ä»¥ç”¨ï¼Ÿ** - ç”¨æˆ·å‡†å…¥å’Œå°ç¦
2. **ç”¨åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿ** - åŠŸèƒ½è¾¹ç•Œå’Œæƒé™
3. **å‡ºäº‹æˆ‘èƒ½ä¸èƒ½ä¸€é”®æ­¢è¡€ï¼Ÿ** - ç´§æ€¥æ§åˆ¶å¼€å…³

### ä¸æ˜¯åå°çš„èŒè´£

- âŒ ç®¡ç†æ¶ˆæ¯ç»†èŠ‚ï¼ˆå¦‚ä½•å‘é€ã€æ ¼å¼ã€å†…å®¹ï¼‰
- âŒ ç®¡ç† UIï¼ˆç•Œé¢æ ·å¼ã€äº¤äº’ç»†èŠ‚ï¼‰
- âŒ ç®¡ç†åŠ å¯†å†…å®¹ï¼ˆç«¯åˆ°ç«¯åŠ å¯†çš„æ¶ˆæ¯ï¼‰
- âŒ è‡ªå®šä¹‰æ¨é€æ–‡æ¡ˆï¼ˆæ¨é€å†…å®¹ç”±å®¢æˆ·ç«¯å®šä¹‰ï¼‰

### æ ¸å¿ƒåŸåˆ™

> **Echo ä¸æ§åˆ¶"æ¨é€è¯´ä»€ä¹ˆ"ï¼Œåªæ§åˆ¶"æ¨é€ä¼šä¸ä¼šå‘ç”Ÿ"**

**ä¸‰æ¡ç”Ÿå­˜çº¿ï¼ˆP0 å¿…é¡»ï¼‰**ï¼š

1. **æœç´¢ä¸å¯å‘ç°æ€§æ˜¯ P0** - ä¸åšå°±ä¼šå¤±æ§ï¼ˆåƒåœ¾å·ã€é»‘äº§ã€éªšæ‰°ï¼‰
2. **ä¼šè¯å¼ºåˆ¶ç™»å‡ºæ˜¯ P0** - ä¸åšå°±æ²¡æ³•çœŸæ­£å°ç¦/æ­¢è¡€
3. **åå°åªç®¡"æ¨é€æ˜¯å¦å‘ç”Ÿ"ï¼Œä¸ç¢°"èŠå¤©æ¨é€å†…å®¹"** - ä¿æŒ Telegram ä½“éªŒ

---

## ğŸ“Š åŠŸèƒ½ä¼˜å…ˆçº§æ€»è§ˆ

### ğŸŸ¥ P0 - å¹³å°ç”Ÿå­˜çº§ï¼ˆå¿…é¡»å®ç°ï¼‰

| # | æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|---|------|------|------|
| 1 | ç”¨æˆ·ç®¡ç† | è´¦å·çŠ¶æ€æ§åˆ¶ | å°å·ã€å†»ç»“ã€å¼ºåˆ¶ç™»å‡º |
| 2 | é£æ§ç³»ç»Ÿ | å°å·/é»‘åå• | IP å°ç¦ã€è®¾å¤‡å°ç¦ã€é£é™©æ ‡è®° |
| 3 | å¯¹è¯ç®¡ç† | ç¾¤ç»„/é¢‘é“æ§åˆ¶ | è§£æ•£ç¾¤ã€å°ç¦ç¾¤ã€ç¦æ­¢åˆ›å»º |
| 4 | æ–‡ä»¶æ§åˆ¶ | ä¸Šä¼ å¼€å…³ | å…¨å±€/æŒ‰ç¾¤æ§åˆ¶æ–‡ä»¶ä¸Šä¼  |
| 5 | **æœç´¢ä¸å¯å‘ç°æ€§** â­â­â­ | **å…¨å±€æœç´¢æ§åˆ¶** | **æœç´¢æ€»å¼€å…³ã€ç™½åå•ã€é£æ§è”åŠ¨ï¼ˆç”Ÿå­˜çº¿ï¼‰** |
| 6 | **ä¼šè¯ç®¡ç†** â­â­â­ | **å¼ºåˆ¶ç™»å‡º** | **ç»ˆæ­¢ä¼šè¯ã€å¼‚å¸¸æ£€æµ‹ï¼ˆå°ç¦å¿…å¤‡ï¼‰** |
| 7 | **å¹³å°éšç§ç­–ç•¥** â­ | **åŠŸèƒ½å¼€å…³** | **å…¨å±€ç¦ç”¨é€šè¯/è¯­éŸ³/ä½ç½®ç­‰** |
| 8 | å†…å®¹æ²»ç† | ä¸¾æŠ¥å¤„ç† | è¢«åŠ¨å“åº”ä¸¾æŠ¥ï¼Œåˆ é™¤/ç¦è¨€ |
| 9 | **æ¨é€æ§åˆ¶** â­â­â­ | **æ¨é€å¼€å…³** | **æ§åˆ¶æ¨é€æ˜¯å¦å‘ç”Ÿï¼ˆä¸æ˜¯å†…å®¹ï¼‰** |
| 10 | **è¯ˆéª—/è™šå‡æ ‡è®°** â­ | **æ ‡è®°ç®¡ç†** | **æ ‡è®°è¯ˆéª—/è™šå‡ç”¨æˆ·å’Œç¾¤ç»„** |
| 11 | **æ¶ˆæ¯ç±»å‹æ§åˆ¶** â­ | **ç±»å‹é™åˆ¶** | **æŒ‰ç¾¤ç»„ç¦ç”¨ç‰¹å®šæ¶ˆæ¯ç±»å‹** |
| 12 | ç³»ç»Ÿå¼€å…³ | ç´§æ€¥æ­¢è¡€ | å…³é—­æ³¨å†Œã€åªè¯»æ¨¡å¼ |

### ğŸŸ§ P1 - å¹³å°å·®å¼‚åŒ–ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰

| # | æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|---|------|------|------|
| 11 | é‚€è¯·ç³»ç»Ÿ | æ³¨å†Œé—¨æ§› | é‚€è¯·ç ã€é…é¢ã€å…³ç³»é“¾ |
| 12 | æƒé™è¾¹ç•Œ | ç¾¤ç»„æƒé™ | è½¬å‘æ§åˆ¶ã€æ–°æˆå‘˜é™åˆ¶ |
| 13 | ç³»ç»Ÿæ¨é€ | éèŠå¤©æ¨é€ | å¹³å°å…¬å‘Šã€ç³»ç»Ÿé€šçŸ¥ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ |
| 14 | æ•°æ®ç»Ÿè®¡ | åŸºç¡€æŒ‡æ ‡ | DAU/MAUã€æ´»è·ƒåº¦ |
| 15 | **éªŒè¯æ ‡è®°** â­ | **è“Vç®¡ç†** | **å®˜æ–¹è´¦å·/ç¾¤ç»„éªŒè¯æ ‡è®°** |
| 16 | **ç”¨æˆ·åç®¡ç†** â­ | **å…¬å¼€ç”¨æˆ·å** | **ä¿ç•™/ç§»é™¤å…¬å¼€ç”¨æˆ·å** |


### ğŸŸ¨ P2 - è¿è¥æ‰©å±•ï¼ˆå¯é€‰ï¼‰

| # | æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|---|------|------|------|
| 17 | åœˆå­/æ ‡ç­¾ | å…´è¶£åˆ†ç±» | åŸºäºç¾¤ç»„çš„æ ‡ç­¾ç³»ç»Ÿ |
| 18 | å¹¿åœº/æ¨è | å†…å®¹èšåˆ | æ‰‹åŠ¨æ¨èã€çƒ­åº¦æ’åº |
| 19 | å†…å®¹èšåˆ | ç²¾é€‰æ¶ˆæ¯ | å®˜æ–¹åˆé›†ï¼ˆåªè¯»ï¼‰ |

### ğŸŸ© P3 - é•¿æœŸè§„åˆ’

| # | æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|---|------|------|------|
| 20 | Bot ç®¡ç† | æœºå™¨äººæ§åˆ¶ | ç™½åå•ã€æƒé™ç®¡ç† |
| 21 | åæ»¥ç”¨è‡ªåŠ¨åŒ– | è¡Œä¸ºæ£€æµ‹ | é¢‘ç‡é™åˆ¶ã€å¼‚å¸¸æ£€æµ‹ |
| 22 | å¤šèŠ‚ç‚¹/ç¾å¤‡ | é«˜å¯ç”¨ | èŠ‚ç‚¹ç®¡ç†ã€æµé‡åˆ‡æ¢ |
| 23 | åˆè§„å·¥å…· | æ³•å¾‹å“åº” | æ•°æ®å¯¼å‡ºã€åˆ é™¤è¯·æ±‚ |

---

## ğŸŸ¥ P0 åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 1ï¸âƒ£ ç”¨æˆ·ç®¡ç† - è´¦å·çŠ¶æ€æ§åˆ¶

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… æ‰‹æœºå·æ³¨å†Œ
- âœ… å¤šè®¾å¤‡ç™»å½•
- âœ… ä¼šè¯ç®¡ç†
- âœ… ç”¨æˆ·èµ„æ–™ï¼ˆå¤´åƒã€æ˜µç§°ã€bioï¼‰
- âœ… ç”¨æˆ·åç³»ç»Ÿï¼ˆ@usernameï¼‰
- âœ… åœ¨çº¿çŠ¶æ€

#### åå°å¿…é¡»èƒ½åšçš„

**ç”¨æˆ·åˆ—è¡¨**:
```typescript
interface UserListItem {
  userId: string;           // å†…éƒ¨ IDï¼ˆä¸æ˜¾ç¤ºç»™ç®¡ç†å‘˜ï¼‰
  phone: string;            // æ‰‹æœºå·ï¼ˆè„±æ•æ˜¾ç¤ºï¼‰
  username?: string;        // @username
  displayName: string;      // æ˜¾ç¤ºåç§°
  registeredAt: Date;       // æ³¨å†Œæ—¶é—´
  lastActiveAt: Date;       // æœ€åæ´»è·ƒ
  status: 'normal' | 'frozen' | 'banned';  // è´¦å·çŠ¶æ€
  deviceCount: number;      // è®¾å¤‡æ•°é‡
  riskLevel: 'low' | 'medium' | 'high';    // é£é™©ç­‰çº§
}
```

**è´¦å·çŠ¶æ€æ§åˆ¶**:
- **æ­£å¸¸ (normal)**: æ‰€æœ‰åŠŸèƒ½å¯ç”¨
- **å†»ç»“ (frozen)**: 
  - å¯ä»¥ç™»å½•å’ŒæŸ¥çœ‹æ¶ˆæ¯
  - ä¸èƒ½å‘é€æ¶ˆæ¯
  - ä¸èƒ½åˆ›å»ºç¾¤ç»„
  - ä¸èƒ½ä¸Šä¼ æ–‡ä»¶
- **å°ç¦ (banned)**:
  - æ— æ³•ç™»å½•
  - æ‰€æœ‰è®¾å¤‡å¼ºåˆ¶ç™»å‡º
  - æ— æ³•æ³¨å†Œæ–°è´¦å·ï¼ˆåŒè®¾å¤‡/IPï¼‰


**æ“ä½œåŠŸèƒ½**:
- æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…ï¼ˆåŸºæœ¬ä¿¡æ¯ã€è®¾å¤‡åˆ—è¡¨ã€æ´»è·ƒç¾¤ç»„ï¼‰
- å†»ç»“è´¦å·ï¼ˆä¸´æ—¶é™åˆ¶ï¼‰
- å°ç¦è´¦å·ï¼ˆæ°¸ä¹…ç¦æ­¢ï¼‰
- è§£å°è´¦å·
- å¼ºåˆ¶ç™»å‡ºæ‰€æœ‰è®¾å¤‡
- æŸ¥çœ‹æ´»è·ƒä¼šè¯ï¼ˆè®¾å¤‡ç±»å‹ã€IPã€æœ€åæ´»è·ƒæ—¶é—´ï¼‰
- è¸¢æ‰ç‰¹å®šè®¾å¤‡ä¼šè¯

**æ§åˆ¶ç²’åº¦**: è´¦å·çº§ / ä¼šè¯çº§ï¼ˆä¸æ˜¯æ¶ˆæ¯çº§ï¼‰

**æ•°æ®æ¥æº**: 
- Echo DB (åªè¯»): `users`, `auth_keys`, `user_presences`
- Echo DB (è¯»å†™): `user_status`, `user_risk_scores`, `ban_records`

---

### 2ï¸âƒ£ é£æ§ç³»ç»Ÿ - å°å·/é»‘åå•

#### Telegram å®˜æ–¹èƒ½åŠ›
- âœ… å®˜æ–¹å¯å°å·
- âœ… å®˜æ–¹å¯é™åˆ¶è´¦å·è¡Œä¸º

#### åå°å¿…é¡»èƒ½åšçš„

**é£æ§ç»´åº¦**:
```typescript
interface RiskControl {
  // IP å°ç¦
  bannedIPs: string[];           // å°ç¦çš„ IP åˆ—è¡¨
  ipWhitelist: string[];         // IP ç™½åå•
  
  // è®¾å¤‡å°ç¦
  bannedDevices: string[];       // è®¾å¤‡æŒ‡çº¹
  
  // è¡Œä¸ºé£æ§
  maxRegistrationsPerIP: number; // å• IP æ³¨å†Œä¸Šé™
  maxDevicesPerUser: number;     // å•ç”¨æˆ·è®¾å¤‡ä¸Šé™
  
  // é£é™©æ ‡è®°
  riskUsers: {
    userId: string;
    level: 'low' | 'medium' | 'high';
    reason: string;
    markedAt: Date;
  }[];
}
```

**å°ç¦ç±»å‹**:
1. **ç”¨æˆ·å°ç¦**: å°ç¦ç‰¹å®šç”¨æˆ·
2. **IP å°ç¦**: å°ç¦ç‰¹å®š IPï¼ˆé˜²æ­¢é‡æ–°æ³¨å†Œï¼‰
3. **è®¾å¤‡å°ç¦**: å°ç¦ç‰¹å®šè®¾å¤‡ï¼ˆé˜²æ­¢æ¢å·ï¼‰
4. **æ‰¹é‡å°ç¦**: æ‰¹é‡å¤„ç†é£é™©è´¦å·

**é£é™©æ ‡è®°**:
- å¼‚å¸¸æ³¨å†Œï¼ˆçŸ­æ—¶é—´å¤§é‡æ³¨å†Œï¼‰
- å¼‚å¸¸è¡Œä¸ºï¼ˆé¢‘ç¹åˆ›å»ºç¾¤ã€å‘é€æ¶ˆæ¯ï¼‰
- ä¸¾æŠ¥æ¬¡æ•°è¿‡å¤š
- è®¾å¤‡å¼‚å¸¸ï¼ˆæ¨¡æ‹Ÿå™¨ã€å¤šå¼€ï¼‰

**æ§åˆ¶ç²’åº¦**: è¡Œä¸ºå±‚æ§åˆ¶ï¼Œä¸ç¢°åŠ å¯†å†…å®¹

**æ•°æ®æ¥æº**:
- Echo DB: `banned_ips`, `banned_devices`, `risk_scores`, `ban_logs`

---

### 3ï¸âƒ£ å¯¹è¯ç®¡ç† - ç¾¤ç»„/é¢‘é“æ§åˆ¶

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… ç§èŠï¼ˆ1å¯¹1ï¼‰
- âœ… åŸºç¡€ç¾¤ç»„ï¼ˆBasic Groupsï¼‰
- âœ… è¶…çº§ç¾¤ç»„ï¼ˆSupergroupsï¼‰
- âœ… é¢‘é“ï¼ˆChannelsï¼‰


#### åå°å¿…é¡»èƒ½åšçš„

**âš ï¸ é‡ç‚¹**: ä¸æ˜¯"ç®¡ç†èŠå¤©å†…å®¹"ï¼Œæ˜¯"æ§åˆ¶ç©ºé—´æ˜¯å¦å­˜åœ¨"

**ç¾¤ç»„/é¢‘é“åˆ—è¡¨**:
```typescript
interface ChatListItem {
  chatId: string;
  type: 'private' | 'group' | 'supergroup' | 'channel';
  title: string;
  creator: string;           // åˆ›å»ºè€…
  memberCount: number;       // æˆå‘˜æ•°
  createdAt: Date;
  isPublic: boolean;         // æ˜¯å¦å…¬å¼€
  username?: string;         // å…¬å¼€é“¾æ¥
  status: 'active' | 'banned' | 'dissolved';
}
```

**æ“ä½œåŠŸèƒ½**:
- **ç¦æ­¢åˆ›å»ºæ–°ç¾¤/é¢‘é“**: å…¨å±€å¼€å…³
- **è§£æ•£ç¾¤/é¢‘é“**: å¼ºåˆ¶è§£æ•£ï¼ˆæ‰€æœ‰æˆå‘˜é€€å‡ºï¼‰
- **å°ç¦ç¾¤/é¢‘é“**: ç¦æ­¢å‘è¨€ï¼Œä½†ä¸è§£æ•£
- **æŸ¥çœ‹ç¾¤åŸºæœ¬ä¿¡æ¯**:
  - æˆå‘˜æ•°
  - åˆ›å»ºè€…
  - æ˜¯å¦å…¬å¼€
  - æ´»è·ƒåº¦
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡è§£æ•£/å°ç¦

**ä¸èƒ½åšçš„**:
- âŒ æŸ¥çœ‹èŠå¤©å†…å®¹ï¼ˆåŠ å¯†æ¶ˆæ¯ï¼‰
- âŒ ä¿®æ”¹ç¾¤è®¾ç½®ï¼ˆç”±ç¾¤ä¸»ç®¡ç†ï¼‰
- âŒ è¸¢å‡ºç‰¹å®šæˆå‘˜ï¼ˆç”±ç¾¤ä¸»ç®¡ç†ï¼‰

**æ§åˆ¶ç²’åº¦**: å¯¹è¯å®ä½“çº§ï¼ˆdialog levelï¼‰

**æ•°æ®æ¥æº**:
- Echo DB (åªè¯»): `chats`, `channels`, `chat_participants`
- Echo DB (è¯»å†™): `chat_status`, `banned_chats`, `dissolution_logs`

---

### 4ï¸âƒ£ æ–‡ä»¶æ§åˆ¶ - ä¸Šä¼ å¼€å…³

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… æ–‡ä»¶ä¸Šä¼ ï¼ˆå›¾ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ï¼‰
- âœ… å¤§æ–‡ä»¶æ”¯æŒï¼ˆ2GB+ï¼‰
- âœ… äº‘ç«¯å­˜å‚¨

#### åå°å¿…é¡»èƒ½åšçš„

**æ–‡ä»¶æ§åˆ¶ç­–ç•¥**:
```typescript
interface FileControl {
  // å…¨å±€æ§åˆ¶
  globalUploadEnabled: boolean;
  
  // æ–‡ä»¶ç±»å‹é™åˆ¶
  allowedTypes: ('image' | 'video' | 'document' | 'audio')[];
  
  // å¤§å°é™åˆ¶
  maxFileSize: number;           // å•ä½: MB
  maxImageSize: number;
  maxVideoSize: number;
  
  // æŒ‰ç¾¤æ§åˆ¶
  chatFileControls: {
    chatId: string;
    uploadEnabled: boolean;
    allowedTypes: string[];
  }[];
  
  // æŒ‰ç”¨æˆ·æ§åˆ¶
  userFileControls: {
    userId: string;
    uploadEnabled: boolean;
    dailyQuota: number;          // æ¯æ—¥ä¸Šä¼ é…é¢
  }[];
}
```


**æ“ä½œåŠŸèƒ½**:
- **å…¨å±€å…³é—­æ–‡ä»¶ä¸Šä¼ **: ç´§æ€¥æ­¢è¡€
- **æŒ‰ç¾¤å…³é—­åª’ä½“**: ç‰¹å®šç¾¤ç¦æ­¢ä¸Šä¼ 
- **é™åˆ¶æ–‡ä»¶ç±»å‹**: åªå…è®¸å›¾ç‰‡ï¼Œç¦æ­¢è§†é¢‘/æ–‡æ¡£
- **é™åˆ¶æ–‡ä»¶å¤§å°**: è®¾ç½®ä¸Šä¼ å¤§å°ä¸Šé™
- **ç´§æ€¥åªè¯»æ¨¡å¼**: å…¨ç«™åªå…è®¸æ–‡æœ¬æ¶ˆæ¯

**æ§åˆ¶ç²’åº¦**: ä¸Šä¼ å±‚æ§åˆ¶ï¼Œä¸è§£æå†…å®¹

**å®ç°æ–¹å¼**:
- Echo Business Server æ‹¦æˆªä¸Šä¼ è¯·æ±‚
- æ£€æŸ¥ç”¨æˆ·/ç¾¤ç»„çš„ä¸Šä¼ æƒé™
- æ£€æŸ¥æ–‡ä»¶ç±»å‹å’Œå¤§å°
- å…è®¸/æ‹’ç»ä¸Šä¼ åˆ° MinIO

**æ•°æ®æ¥æº**:
- Echo DB: `file_control_policies`, `upload_quotas`, `upload_logs`

---

### 5ï¸âƒ£ æœç´¢ä¸å¯å‘ç°æ€§æ§åˆ¶ â­

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… å…¨å±€æœç´¢ï¼ˆæœç´¢ç”¨æˆ·ã€ç¾¤ç»„ã€é¢‘é“ï¼‰
- âœ… é€šè¿‡ @username æœç´¢
- âœ… é€šè¿‡æ‰‹æœºå·æœç´¢ï¼ˆéœ€è¦å¯¹æ–¹å…è®¸ï¼‰
- âœ… é™„è¿‘çš„äººï¼ˆåŸºäºåœ°ç†ä½ç½®ï¼‰
- âœ… æœç´¢å†å²

#### åå°å¿…é¡»èƒ½åšçš„

**å…¨å±€æœç´¢æ§åˆ¶å°**:
```typescript
interface GlobalSearchControl {
  // æœç´¢æ€»å¼€å…³
  globalSearchEnabled: boolean;
  
  // ç”¨æˆ·æœç´¢æ§åˆ¶
  userSearch: {
    byUsername: boolean;        // å…è®¸é€šè¿‡ @username æœç´¢
    byPhone: boolean;           // å…è®¸é€šè¿‡æ‰‹æœºå·æœç´¢
    nearbyEnabled: boolean;     // é™„è¿‘çš„äººåŠŸèƒ½
  };
  
  // ç¾¤ç»„/é¢‘é“æœç´¢æ§åˆ¶
  chatSearch: {
    publicChatsEnabled: boolean;  // å…¬å¼€ç¾¤ç»„å¯æœç´¢
    channelsEnabled: boolean;     // é¢‘é“å¯æœç´¢
  };
  
  // æœç´¢ç™½åå•
  searchWhitelist: {
    users: string[];            // å…è®¸è¢«æœç´¢çš„ç”¨æˆ·
    chats: string[];            // å…è®¸è¢«æœç´¢çš„ç¾¤ç»„
  };
  
  // é£æ§è”åŠ¨
  autoHideScam: boolean;        // è‡ªåŠ¨éšè—è¯ˆéª—æ ‡è®°å¯¹è±¡
  autoHideFake: boolean;        // è‡ªåŠ¨éšè—è™šå‡æ ‡è®°å¯¹è±¡
  autoHideRestricted: boolean;  // è‡ªåŠ¨éšè—å—é™å¯¹è±¡
}
```

**ç”¨æˆ·å¯å‘ç°æ€§æ§åˆ¶**:
```typescript
interface UserDiscoverability {
  userId: string;
  username: string;
  
  // å¯å‘ç°æ€§è®¾ç½®
  searchable: boolean;          // æ˜¯å¦å¯è¢«æœç´¢
  searchableByUsername: boolean;// å¯é€šè¿‡ @username æœç´¢
  searchableByPhone: boolean;   // å¯é€šè¿‡æ‰‹æœºå·æœç´¢
  showInNearby: boolean;        // æ˜¾ç¤ºåœ¨é™„è¿‘çš„äºº
  showInSuggestions: boolean;   // æ˜¾ç¤ºåœ¨æ¨èåˆ—è¡¨
  
  // é£æ§è”åŠ¨
  isScam: boolean;              // è¯ˆéª—æ ‡è®°ï¼ˆè‡ªåŠ¨éšè—ï¼‰
  isFake: boolean;              // è™šå‡æ ‡è®°ï¼ˆè‡ªåŠ¨éšè—ï¼‰
  isRestricted: boolean;        // å—é™çŠ¶æ€ï¼ˆè‡ªåŠ¨éšè—ï¼‰
  
  updatedBy: string;
  updatedAt: Date;
}
```

**ç¾¤ç»„/é¢‘é“å¯å‘ç°æ€§æ§åˆ¶**:
```typescript
interface ChatDiscoverability {
  chatId: string;
  chatTitle: string;
  type: 'group' | 'supergroup' | 'channel';
  
  // å¯å‘ç°æ€§è®¾ç½®
  searchable: boolean;          // æ˜¯å¦å¯è¢«æœç´¢
  publicUsername: string | null;// å…¬å¼€ç”¨æˆ·å
  inviteOnly: boolean;          // ä»…é‚€è¯·
  requireApproval: boolean;     // éœ€è¦å®¡æ‰¹
  
  // ç™½åå•æœºåˆ¶
  inWhitelist: boolean;         // åœ¨ç™½åå•ä¸­
  whitelistReason?: string;
  
  // é£æ§è”åŠ¨
  isScam: boolean;
  isFake: boolean;
  isRestricted: boolean;
  
  updatedBy: string;
  updatedAt: Date;
}
```

**æ“ä½œåŠŸèƒ½**:
- **å…¨å±€æ§åˆ¶**:
  - å…³é—­/å¼€å¯å…¨å±€æœç´¢
  - å…³é—­/å¼€å¯ç”¨æˆ·åæœç´¢
  - å…³é—­/å¼€å¯æ‰‹æœºå·æœç´¢
  - å…³é—­/å¼€å¯é™„è¿‘çš„äºº
- **ç™½åå•ç®¡ç†**:
  - æ·»åŠ åˆ°æœç´¢ç™½åå•
  - ä»ç™½åå•ç§»é™¤
  - æ‰¹é‡å¯¼å…¥ç™½åå•
  - å¯¼å‡ºç™½åå•
- **å¯å‘ç°æ€§æ§åˆ¶**:
  - è®¾ç½®ç”¨æˆ·ä¸å¯æœç´¢
  - è®¾ç½®ç¾¤ç»„ä¸å¯æœç´¢
  - æ‰¹é‡è®¾ç½®å¯å‘ç°æ€§
- **é£æ§è”åŠ¨**:
  - è‡ªåŠ¨éšè—è¯ˆéª—/è™šå‡å¯¹è±¡
  - è‡ªåŠ¨éšè—å—é™å¯¹è±¡
  - æŸ¥çœ‹éšè—åˆ—è¡¨

**æ§åˆ¶ç²’åº¦**: å…¨å±€çº§ / ç”¨æˆ·çº§ / ç¾¤ç»„çº§

**å®ç°æ–¹å¼**:
- Echo Business Server ç»´æŠ¤æœç´¢ç´¢å¼•
- è¿‡æ»¤ä¸å¯æœç´¢çš„ç”¨æˆ·/ç¾¤ç»„
- Echo æœç´¢ API è¿”å›ç»“æœåå†è¿‡æ»¤
- é£æ§æ ‡è®°è‡ªåŠ¨è”åŠ¨éšè—

**æ•°æ®æ¥æº**:
- Echo DB (åªè¯»): `users`, `chats`, `usernames`
- Echo DB (è¯»å†™): `discoverability_settings`, `search_whitelist`, `search_logs`

---

### 6ï¸âƒ£ ä¼šè¯ç®¡ç† - å¼ºåˆ¶ç™»å‡º â­

#### Telegram å®¢æˆ·ç«¯çœŸå®å­˜åœ¨

```java
// SessionsActivity.java - çœŸå®ä¼šè¯ç®¡ç†
class SessionsActivity {
    // è®¾å¤‡ä¼šè¯åˆ—è¡¨
    ArrayList<TL_authorization> sessions;
    
    // ä¼šè¯ä¿¡æ¯
    class TL_authorization {
        long hash;              // ä¼šè¯ hash
        String device_model;    // è®¾å¤‡å‹å·
        String platform;        // å¹³å°
        String system_version;  // ç³»ç»Ÿç‰ˆæœ¬
        String app_name;        // åº”ç”¨åç§°
        String app_version;     // åº”ç”¨ç‰ˆæœ¬
        int date_created;       // åˆ›å»ºæ—¶é—´
        int date_active;        // æœ€åæ´»è·ƒ
        String ip;              // IP åœ°å€
        String country;         // å›½å®¶
        String region;          // åœ°åŒº
    }
    
    // ç»ˆæ­¢ä¼šè¯
    void terminateSession(long hash);
    
    // ç»ˆæ­¢æ‰€æœ‰å…¶ä»–ä¼šè¯
    void terminateAllSessions();
}
```

#### åå°å¿…é¡»èƒ½åšçš„

**ä¼šè¯ç®¡ç†**:
```typescript
interface SessionManagement {
  // æŸ¥çœ‹ç”¨æˆ·æ‰€æœ‰ä¼šè¯
  getUserSessions(userId: string): Session[];
  
  // ç»ˆæ­¢ç‰¹å®šä¼šè¯
  terminateSession(userId: string, sessionHash: string, reason: string): void;
  
  // ç»ˆæ­¢æ‰€æœ‰ä¼šè¯ï¼ˆå¼ºåˆ¶ç™»å‡ºï¼‰
  terminateAllSessions(userId: string, reason: string): void;
  
  // å¼‚å¸¸ä¼šè¯æ£€æµ‹
  detectAbnormalSessions(userId: string): AbnormalSession[];
}
```

**ä¼šè¯ä¿¡æ¯**:
```typescript
interface Session {
  sessionHash: string;
  userId: string;
  
  // è®¾å¤‡ä¿¡æ¯
  deviceModel: string;
  platform: 'android' | 'ios' | 'desktop' | 'web';
  systemVersion: string;
  appName: string;
  appVersion: string;
  
  // æ—¶é—´ä¿¡æ¯
  createdAt: Date;
  lastActiveAt: Date;
  
  // ä½ç½®ä¿¡æ¯
  ip: string;
  country: string;
  region: string;
  city?: string;
  
  // çŠ¶æ€
  status: 'online' | 'offline';
  isAbnormal: boolean;          // å¼‚å¸¸æ ‡è®°
  abnormalReason?: string;
  
  // æ“ä½œè®°å½•
  terminatedBy?: string;
  terminatedAt?: Date;
  terminateReason?: string;
}
```

**å¼‚å¸¸ä¼šè¯æ£€æµ‹**:
```typescript
interface AbnormalSessionDetection {
  // å¼‚å¸¸ç±»å‹
  type: 'location_change' | 'device_change' | 'concurrent_login' | 'suspicious_ip';
  
  // æ£€æµ‹è§„åˆ™
  rules: {
    // åœ°ç†ä½ç½®å¼‚å¸¸
    locationChange: {
      enabled: boolean;
      maxDistanceKm: number;    // æœ€å¤§è·ç¦»ï¼ˆå…¬é‡Œï¼‰
      timeWindowMinutes: number;// æ—¶é—´çª—å£ï¼ˆåˆ†é’Ÿï¼‰
    };
    
    // è®¾å¤‡å¼‚å¸¸
    deviceChange: {
      enabled: boolean;
      alertOnNewDevice: boolean;
    };
    
    // å¹¶å‘ç™»å½•
    concurrentLogin: {
      enabled: boolean;
      maxConcurrent: number;    // æœ€å¤§å¹¶å‘æ•°
    };
    
    // å¯ç–‘ IP
    suspiciousIP: {
      enabled: boolean;
      blacklist: string[];      // IP é»‘åå•
      vpnDetection: boolean;    // VPN æ£€æµ‹
    };
  };
}
```

**æ“ä½œåŠŸèƒ½**:
- **æŸ¥çœ‹ä¼šè¯**:
  - æŸ¥çœ‹ç”¨æˆ·æ‰€æœ‰æ´»è·ƒä¼šè¯
  - æŸ¥çœ‹ä¼šè¯è¯¦ç»†ä¿¡æ¯
  - æŸ¥çœ‹ä¼šè¯å†å²
- **ç»ˆæ­¢ä¼šè¯**:
  - ç»ˆæ­¢ç‰¹å®šä¼šè¯
  - ç»ˆæ­¢æ‰€æœ‰ä¼šè¯ï¼ˆå¼ºåˆ¶ç™»å‡ºï¼‰
  - æ‰¹é‡ç»ˆæ­¢å¼‚å¸¸ä¼šè¯
- **å¼‚å¸¸æ£€æµ‹**:
  - æ£€æµ‹å¼‚å¸¸ä¼šè¯
  - æ ‡è®°å¯ç–‘ä¼šè¯
  - è‡ªåŠ¨ç»ˆæ­¢å¼‚å¸¸ä¼šè¯
- **è”åŠ¨æ“ä½œ**:
  - å°ç¦æ—¶è‡ªåŠ¨ç»ˆæ­¢æ‰€æœ‰ä¼šè¯
  - å†»ç»“æ—¶è‡ªåŠ¨ç»ˆæ­¢æ‰€æœ‰ä¼šè¯
  - å¯†ç ä¿®æ”¹æ—¶è‡ªåŠ¨ç»ˆæ­¢æ‰€æœ‰ä¼šè¯

**æ§åˆ¶ç²’åº¦**: ä¼šè¯çº§æ§åˆ¶

**å®ç°æ–¹å¼**:
- é€šè¿‡ Echo API æŸ¥è¯¢ä¼šè¯åˆ—è¡¨
- é€šè¿‡ Echo API ç»ˆæ­¢ä¼šè¯
- Echo Business Server è®°å½•æ“ä½œæ—¥å¿—
- å¼‚å¸¸æ£€æµ‹è§„åˆ™åœ¨ Echo ä¾§å®ç°

**æ•°æ®æ¥æº**:
- Echo DB (åªè¯»): `auth_keys`, `user_presences`
- Echo DB (è¯»å†™): `session_logs`, `abnormal_sessions`, `session_termination_logs`

---

### 7ï¸âƒ£ å¹³å°éšç§ç­–ç•¥ â­

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… ç”¨æˆ·ä¸ªäººéšç§è®¾ç½®ï¼ˆè°èƒ½çœ‹æˆ‘çš„æ‰‹æœºå·ã€æœ€åä¸Šçº¿æ—¶é—´ç­‰ï¼‰
- âœ… é€šè¯åŠŸèƒ½ï¼ˆè¯­éŸ³/è§†é¢‘é€šè¯ï¼‰
- âœ… P2P è¿æ¥ï¼ˆç‚¹å¯¹ç‚¹è¿æ¥ï¼‰
- âœ… è¯­éŸ³æ¶ˆæ¯
- âœ… ä½ç½®åˆ†äº«

#### åå°å¿…é¡»èƒ½åšçš„

**âš ï¸ é‡ç‚¹**: ä¸ç®¡ç†ç”¨æˆ·ä¸ªäººéšç§è®¾ç½®ï¼Œåªæ§åˆ¶å¹³å°çº§åŠŸèƒ½å¼€å…³

**å¹³å°éšç§ç­–ç•¥**:
```typescript
interface PlatformPrivacyPolicy {
  // é€šè¯åŠŸèƒ½æ§åˆ¶
  calls: {
    voiceCallsEnabled: boolean;   // è¯­éŸ³é€šè¯
    videoCallsEnabled: boolean;   // è§†é¢‘é€šè¯
    groupCallsEnabled: boolean;   // ç¾¤ç»„é€šè¯
    p2pEnabled: boolean;          // P2P è¿æ¥
  };
  
  // æ¶ˆæ¯ç±»å‹æ§åˆ¶
  messages: {
    voiceMessagesEnabled: boolean;// è¯­éŸ³æ¶ˆæ¯
    videoMessagesEnabled: boolean;// è§†é¢‘æ¶ˆæ¯
    locationSharingEnabled: boolean;// ä½ç½®åˆ†äº«
  };
  
  // éšç§åŠŸèƒ½æ§åˆ¶
  privacy: {
    phoneNumberDiscoveryEnabled: boolean;  // é€šè¿‡æ‰‹æœºå·å‘ç°
    usernameSearchEnabled: boolean;        // é€šè¿‡ç”¨æˆ·åæœç´¢
    nearbyPeopleEnabled: boolean;          // é™„è¿‘çš„äºº
    profilePhotoEnabled: boolean;          // å¤´åƒæ˜¾ç¤º
  };
  
  // æ•°æ®æ”¶é›†æ§åˆ¶
  dataCollection: {
    analyticsEnabled: boolean;    // åˆ†ææ•°æ®æ”¶é›†
    crashReportsEnabled: boolean; // å´©æºƒæŠ¥å‘Š
    usageStatsEnabled: boolean;   // ä½¿ç”¨ç»Ÿè®¡
  };
}
```

**æ“ä½œåŠŸèƒ½**:
- **åŠŸèƒ½å¼€å…³**:
  - å…¨å±€ç¦ç”¨è¯­éŸ³/è§†é¢‘é€šè¯
  - å…¨å±€ç¦ç”¨ P2P è¿æ¥
  - å…¨å±€ç¦ç”¨è¯­éŸ³æ¶ˆæ¯
  - å…¨å±€ç¦ç”¨ä½ç½®åˆ†äº«
- **éšç§åŠŸèƒ½**:
  - ç¦ç”¨æ‰‹æœºå·å‘ç°
  - ç¦ç”¨é™„è¿‘çš„äºº
  - ç¦ç”¨å¤´åƒæ˜¾ç¤º
- **æ•°æ®æ”¶é›†**:
  - ç¦ç”¨åˆ†ææ•°æ®æ”¶é›†
  - ç¦ç”¨å´©æºƒæŠ¥å‘Š
  - ç¦ç”¨ä½¿ç”¨ç»Ÿè®¡

**æ§åˆ¶ç²’åº¦**: å¹³å°çº§æ§åˆ¶

**å®ç°æ–¹å¼**:
- é€šè¿‡ Remote Config ä¸‹å‘åˆ°å®¢æˆ·ç«¯
- å®¢æˆ·ç«¯æ ¹æ®é…ç½®ç¦ç”¨ç›¸åº”åŠŸèƒ½
- æœåŠ¡ç«¯æ‹¦æˆªè¢«ç¦ç”¨çš„åŠŸèƒ½è¯·æ±‚

**æ•°æ®æ¥æº**:
- Echo DB: `platform_privacy_policy`, `privacy_policy_logs`

---

### 8ï¸âƒ£ å†…å®¹æ²»ç† - ä¸¾æŠ¥å¤„ç†

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… ä¸¾æŠ¥æ¶ˆæ¯
- âœ… ä¸¾æŠ¥ç”¨æˆ·
- âœ… ä¸¾æŠ¥ç¾¤ç»„


#### åå°å¿…é¡»èƒ½åšçš„

**ä¸¾æŠ¥ç®¡ç†**:
```typescript
interface ReportManagement {
  reportId: string;
  type: 'message' | 'user' | 'chat';
  reportedBy: string;          // ä¸¾æŠ¥äºº
  reportedTarget: string;      // è¢«ä¸¾æŠ¥å¯¹è±¡
  reason: 'spam' | 'violence' | 'pornography' | 'other';
  description: string;
  createdAt: Date;
  status: 'pending' | 'reviewing' | 'resolved' | 'dismissed';
  
  // å®šä½ä¿¡æ¯
  messageId?: string;          // æ¶ˆæ¯ IDï¼ˆä½†ä¸è§£å¯†å†…å®¹ï¼‰
  chatId?: string;             // æ‰€åœ¨ç¾¤ç»„
  
  // å¤„ç†è®°å½•
  handledBy?: string;          // å¤„ç†äºº
  handledAt?: Date;
  action?: 'delete' | 'ban_user' | 'ban_chat' | 'warn' | 'dismiss';
  note?: string;
}
```

**æ“ä½œåŠŸèƒ½**:
- **æŸ¥çœ‹ä¸¾æŠ¥åˆ—è¡¨**: æŒ‰çŠ¶æ€ã€ç±»å‹ç­›é€‰
- **å®šä½åˆ°å¯¹è±¡**:
  - ç”¨æˆ· â†’ æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…
  - ç¾¤ç»„ â†’ æŸ¥çœ‹ç¾¤ç»„è¯¦æƒ…
  - æ¶ˆæ¯ â†’ å®šä½åˆ° message_idï¼ˆä½†ä¸è§£å¯†å†…å®¹ï¼‰
- **å¤„ç†æ“ä½œ**:
  - åˆ é™¤æ¶ˆæ¯ï¼ˆæœåŠ¡å™¨çº§ revokeï¼‰
  - ç¦è¨€ç”¨æˆ·ï¼ˆä¸´æ—¶/æ°¸ä¹…ï¼‰
  - å°ç¦ç”¨æˆ·
  - è§£æ•£ç¾¤ç»„
  - è­¦å‘Šï¼ˆè®°å½•ä½†ä¸å¤„ç½šï¼‰
  - é©³å›ä¸¾æŠ¥

**âš ï¸ é‡ç‚¹**: è¢«åŠ¨è§¦å‘ï¼Œä¸ä¸»åŠ¨æ‰«æ

**æ§åˆ¶ç²’åº¦**: è¢«åŠ¨å“åº”ï¼Œä¸çœ‹å†…å®¹

**æ•°æ®æ¥æº**:
- Echo DB (åªè¯»): `messages` (åªè¯» IDï¼Œä¸è¯»å†…å®¹)
- Echo DB (è¯»å†™): `reports`, `report_actions`, `moderation_logs`

---

### 9ï¸âƒ£ æ¨é€æ§åˆ¶ - æ¨é€å¼€å…³ â­â­â­

#### æ ¸å¿ƒç†å¿µ

> **Echo ä¸æ§åˆ¶"æ¨é€è¯´ä»€ä¹ˆ"ï¼Œåªæ§åˆ¶"æ¨é€ä¼šä¸ä¼šå‘ç”Ÿ"**

#### Telegram æ¨é€æœºåˆ¶

```
æ¶ˆæ¯åˆ°è¾¾æœåŠ¡å™¨
    â†“
æœåŠ¡å™¨åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çº¿
    â†“
ä¸åœ¨çº¿ â†’ è§¦å‘ Push Gateway (FCM/APNs)
    â†“
å®¢æˆ·ç«¯æ”¶åˆ°ç³»ç»Ÿé€šçŸ¥
```

**æ¨é€æ˜¯æœåŠ¡ç«¯è¡Œä¸ºï¼Œä½†å†…å®¹ & æ ·å¼æ˜¯å®¢æˆ·ç«¯å®šä¹‰çš„**

#### Telegram å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½
- âœ… ç§èŠæ¶ˆæ¯æ¨é€
- âœ… ç¾¤æ¶ˆæ¯æ¨é€
- âœ… é¢‘é“æ–°æ¶ˆæ¯æ¨é€
- âœ… @ æåŠæ¨é€
- âœ… å›å¤æ¨é€
- âœ… é™éŸ³/å…æ‰“æ‰°
- âœ… å…¨å±€é€šçŸ¥å¼€å…³
- âœ… æ¯ä¸ªèŠå¤©å•ç‹¬é€šçŸ¥è®¾ç½®

**è¿™äº›å…¨éƒ¨æ˜¯å®¢æˆ·ç«¯å·²æœ‰åŠŸèƒ½ï¼Œä½ ä¸èƒ½ã€ä¹Ÿä¸éœ€è¦é‡åš**


#### åå°å¿…é¡»èƒ½åšçš„

**1. æ¨é€æ€»å¼€å…³ï¼ˆå¹³å°ç”Ÿæ­»çº¿ï¼‰**

```typescript
interface PushGlobalControl {
  // å…¨å±€å¼€å…³
  globalPushEnabled: boolean;    // æ‰€æœ‰ç”¨æˆ·æ¨é€æ€»å¼€å…³
  
  // ç´§æ€¥ç†”æ–­
  emergencyMode: boolean;        // ç´§æ€¥æ¨¡å¼ï¼šå…³é—­æ‰€æœ‰æ¨é€
  
  // æ¨é€æœåŠ¡çŠ¶æ€
  fcmEnabled: boolean;           // Android æ¨é€
  apnsEnabled: boolean;          // iOS æ¨é€
}
```

**æ“ä½œ**: 
- å…¨å±€å…³é—­æ¨é€ï¼ˆæ‰€æœ‰ç”¨æˆ·ï¼‰
- ç´§æ€¥ç†”æ–­ï¼ˆäº‹æ•…æ­¢è¡€ï¼‰
- åˆ†å¹³å°æ§åˆ¶ï¼ˆå…³é—­ Android æˆ– iOSï¼‰

**2. ç”¨æˆ·çº§æ¨é€èµ„æ ¼æ§åˆ¶**

```typescript
interface UserPushControl {
  userId: string;
  pushEnabled: boolean;          // è¯¥ç”¨æˆ·æ˜¯å¦å…è®¸æ¨é€
  reason?: string;               // ç¦ç”¨åŸå› 
  
  // é£æ§é™åˆ¶
  maxPushPerHour: number;        // æ¯å°æ—¶æ¨é€ä¸Šé™
  cooldownSeconds: number;       // æ¨é€å†·å´æœŸï¼ˆæ–°ç”¨æˆ·ï¼‰
}
```

**æ“ä½œ**:
- è¢«å°ç¦ç”¨æˆ· â†’ ä¸å…è®¸è§¦å‘æ¨é€
- é£æ§ç”¨æˆ· â†’ é™åˆ¶æ¨é€é¢‘ç‡
- æ–°æ³¨å†Œç”¨æˆ· â†’ å¯è®¾ç½®æ¨é€å†·å´æœŸ

**3. ç¾¤/é¢‘é“æ¨é€è®¸å¯**

```typescript
interface ChatPushControl {
  chatId: string;
  pushEnabled: boolean;          // è¯¥ç¾¤æ˜¯å¦å…è®¸è§¦å‘æ¨é€
  silentMode: boolean;           // é™é»˜æ¨¡å¼ï¼ˆæ¶ˆæ¯ä¸æ¨é€ï¼‰
  
  // é¢‘ç‡é™åˆ¶
  maxPushPerHour: number;        // è¯¥ç¾¤æ¯å°æ—¶æ¨é€ä¸Šé™
}
```

**æ“ä½œ**:
- æŸä¸ªç¾¤ä¸å…è®¸è§¦å‘ push
- é¢‘é“ï¼šå…è®¸æ¨é€ / é™é»˜å‘å¸ƒï¼ˆno pushï¼‰
- äº‹æ•…ç¾¤ï¼šç«‹å³å…³é—­æ¨é€

**4. æ¨é€é£æ§ï¼ˆä¸æ˜¯å†…å®¹ï¼‰**

```typescript
interface PushRiskControl {
  // é¢‘ç‡é™åˆ¶
  userPushRateLimit: {
    userId: string;
    maxPerHour: number;
    maxPerDay: number;
  }[];
  
  // ç¾¤ç»„æ¨é€é™åˆ¶
  chatPushRateLimit: {
    chatId: string;
    maxPerHour: number;
  }[];
  
  // è‡ªåŠ¨é™é»˜
  autoSilentThreshold: {
    messagesPerMinute: number;   // çŸ­æ—¶é—´å¤§é‡æ¶ˆæ¯ â†’ è‡ªåŠ¨é™é»˜
    duration: number;            // é™é»˜æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰
  };
}
```

**æ“ä½œ**:
- å•ç”¨æˆ·æ¨é€é¢‘ç‡é™åˆ¶
- å•ç¾¤æ¨é€é¢‘ç‡é™åˆ¶
- çŸ­æ—¶é—´å¤§é‡æ¶ˆæ¯ â†’ è‡ªåŠ¨é™é»˜ push


#### ä½ ã€ä¸è¯¥åšã€‘çš„æ¨é€ç›¸å…³åŠŸèƒ½

âŒ **ä¸è¦åšè‡ªå®šä¹‰ push æ–‡æ¡ˆ**
- Telegram å®¢æˆ·ç«¯å·²å®šä¹‰
- ä½ æ”¹ä¸äº†
- æ”¹äº†å°±ä¸æ˜¯ Telegram ä½“éªŒ

âŒ **ä¸è¦è¯•å›¾"åˆ†ææ¶ˆæ¯å†³å®šæ˜¯å¦æ¨é€"**
- åŠ å¯†ä½ ä¹Ÿçœ‹ä¸åˆ°
- è¿™æ˜¯å Telegram ç²¾ç¥çš„

âŒ **ä¸è¦ç»•å¼€ Telegram æ¨é€ç³»ç»Ÿ**
- ä¸è¦è‡ªå·±æ¥ APNs / FCM ç»™èŠå¤©ç”¨
- ä¼šç ´åå¤šç«¯ä¸€è‡´æ€§

#### æ§åˆ¶ç²’åº¦

**æ˜¯å¦è§¦å‘ pushï¼Œè€Œä¸æ˜¯ push å†…å®¹**

#### å®ç°æ–¹å¼

```typescript
// Echo Business Server - Push Gateway
@Injectable()
export class PushGatewayService {
  async shouldSendPush(
    userId: string,
    chatId: string,
    messageId: string,
  ): Promise<boolean> {
    // 1. æ£€æŸ¥å…¨å±€å¼€å…³
    if (!this.config.globalPushEnabled) return false;
    
    // 2. æ£€æŸ¥ç”¨æˆ·æ¨é€èµ„æ ¼
    const userControl = await this.getUserPushControl(userId);
    if (!userControl.pushEnabled) return false;
    
    // 3. æ£€æŸ¥ç¾¤ç»„æ¨é€è®¸å¯
    const chatControl = await this.getChatPushControl(chatId);
    if (!chatControl.pushEnabled) return false;
    
    // 4. æ£€æŸ¥æ¨é€é¢‘ç‡
    const rateOk = await this.checkPushRate(userId, chatId);
    if (!rateOk) return false;
    
    // 5. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨çº¿ï¼ˆä» Echo æŸ¥è¯¢ï¼‰
    const isOnline = await this.echoBridge.isUserOnline(userId);
    if (isOnline) return false;
    
    return true;
  }
}
```

#### æ•°æ®æ¥æº

- Echo DB (åªè¯»): `user_presences` (åœ¨çº¿çŠ¶æ€)
- Echo DB (è¯»å†™): `push_controls`, `push_rate_limits`, `push_logs`

---

### ğŸ”Ÿ è¯ˆéª—/è™šå‡æ ‡è®°ç®¡ç† â­

#### Telegram å®¢æˆ·ç«¯çœŸå®å­˜åœ¨

```java
// TLRPC.User - çœŸå®å­—æ®µ
class User {
    boolean scam;           // è¯ˆéª—æ ‡è®°
    boolean fake;           // è™šå‡æ ‡è®°
    boolean verified;       // éªŒè¯æ ‡è®°ï¼ˆè“Vï¼‰
}

// TLRPC.Chat - çœŸå®å­—æ®µ
class Chat {
    boolean scam;           // è¯ˆéª—æ ‡è®°
    boolean fake;           // è™šå‡æ ‡è®°
    boolean verified;       // éªŒè¯æ ‡è®°
    boolean restricted;     // å—é™çŠ¶æ€
    String restriction_reason;  // é™åˆ¶åŸå› ï¼ˆæ˜¾ç¤ºç»™ç”¨æˆ·ï¼‰
}
```

#### åå°å¿…é¡»èƒ½åšçš„

**æ ‡è®°ç®¡ç†**:
```typescript
interface MarkManagement {
  // æ ‡è®°ä¸ºè¯ˆéª—
  markAsScam(id: string, type: 'user' | 'chat', mark: {
    reason: string;
    evidence: string[];     // è¯æ®ï¼ˆæˆªå›¾/ä¸¾æŠ¥IDï¼‰
    markedBy: string;
  }): void;
  
  // æ ‡è®°ä¸ºè™šå‡
  markAsFake(id: string, type: 'user' | 'chat', mark: {
    reason: string;
    evidence: string[];
    markedBy: string;
  }): void;
  
  // ç§»é™¤æ ‡è®°
  removeMark(id: string, type: 'user' | 'chat', markType: 'scam' | 'fake', reason: string): void;
  
  // æŸ¥çœ‹æ ‡è®°å†å²
  getMarkHistory(id: string, type: 'user' | 'chat'): MarkRecord[];
}
```

**æ ‡è®°è®°å½•**:
```typescript
interface MarkRecord {
  markId: string;
  targetType: 'user' | 'chat';
  targetId: string;
  markType: 'scam' | 'fake';
  reason: string;
  evidence: string[];
  markedBy: string;
  markedAt: Date;
  removedBy?: string;
  removedAt?: Date;
  removeReason?: string;
  status: 'active' | 'removed';
}
```

**æ“ä½œåŠŸèƒ½**:
- æ ‡è®°ç”¨æˆ·/ç¾¤ç»„ä¸ºè¯ˆéª—
- æ ‡è®°ç”¨æˆ·/ç¾¤ç»„ä¸ºè™šå‡
- ç§»é™¤æ ‡è®°
- æŸ¥çœ‹æ ‡è®°å†å²
- æ‰¹é‡æ ‡è®°
- å¯¼å‡ºæ ‡è®°åˆ—è¡¨

**æ§åˆ¶ç²’åº¦**: æ ‡è®°çº§æ§åˆ¶ï¼Œä¸ç¢°å†…å®¹

**å®ç°æ–¹å¼**:
- Echo Business Server ç»´æŠ¤æ ‡è®°çŠ¶æ€
- åŒæ­¥åˆ° Echo DB çš„ `scam`/`fake` å­—æ®µ
- å®¢æˆ·ç«¯æ˜¾ç¤ºè­¦å‘Šæ ‡è¯†

**æ•°æ®æ¥æº**:
- Echo DB (è¯»å†™): `users.scam`, `users.fake`, `chats.scam`, `chats.fake`
- Echo DB (è¯»å†™): `mark_records`

---

### 1ï¸âƒ£1ï¸âƒ£ æ¶ˆæ¯ç±»å‹æ§åˆ¶ â­

#### Telegram å®¢æˆ·ç«¯çœŸå®å­˜åœ¨

```java
// TLRPC.TL_chatBannedRights - çœŸå®æƒé™æ§åˆ¶
class TL_chatBannedRights {
    boolean send_messages;      // å‘é€æ¶ˆæ¯
    boolean send_media;         // å‘é€åª’ä½“
    boolean send_stickers;      // å‘é€è´´çº¸
    boolean send_gifs;          // å‘é€ GIF
    boolean send_polls;         // å‘é€æŠ•ç¥¨
    boolean send_photos;        // å‘é€ç…§ç‰‡
    boolean send_videos;        // å‘é€è§†é¢‘
    boolean send_audios;        // å‘é€éŸ³é¢‘
    boolean send_voices;        // å‘é€è¯­éŸ³
    boolean send_docs;          // å‘é€æ–‡æ¡£
    boolean embed_links;        // åµŒå…¥é“¾æ¥
}
```

#### åå°å¿…é¡»èƒ½åšçš„

**æŒ‰ç¾¤ç»„æ§åˆ¶æ¶ˆæ¯ç±»å‹**:
```typescript
interface MessageTypeControl {
  // è®¾ç½®ç¾¤ç»„æ¶ˆæ¯ç±»å‹é™åˆ¶
  setChatMessageTypeRestrictions(chatId: string, restrictions: {
    photos: boolean;          // ç¦æ­¢ç…§ç‰‡
    videos: boolean;          // ç¦æ­¢è§†é¢‘
    files: boolean;           // ç¦æ­¢æ–‡ä»¶
    voice: boolean;           // ç¦æ­¢è¯­éŸ³
    stickers: boolean;        // ç¦æ­¢è´´çº¸
    gifs: boolean;            // ç¦æ­¢ GIF
    polls: boolean;           // ç¦æ­¢æŠ•ç¥¨
    links: boolean;           // ç¦æ­¢é“¾æ¥
    reason: string;
  }): void;
  
  // æ‰¹é‡è®¾ç½®
  batchSetMessageTypeRestrictions(chatIds: string[], restrictions: MessageTypeRestrictions): void;
  
  // æŸ¥çœ‹é™åˆ¶
  getChatMessageTypeRestrictions(chatId: string): MessageTypeRestrictions;
  
  // ç§»é™¤é™åˆ¶
  removeChatMessageTypeRestrictions(chatId: string): void;
}
```

**å…¨å±€æ¶ˆæ¯ç±»å‹ç­–ç•¥**:
```typescript
interface GlobalMessageTypePolicy {
  // å…¨å±€ç¦ç”¨ç‰¹å®šæ¶ˆæ¯ç±»å‹
  disableMessageTypeGlobally(type: MessageType, reason: string): void;
  
  // æ–°ç¾¤é»˜è®¤é™åˆ¶
  setNewChatDefaultRestrictions(restrictions: MessageTypeRestrictions): void;
}
```

**æ“ä½œåŠŸèƒ½**:
- è®¾ç½®ç¾¤ç»„æ¶ˆæ¯ç±»å‹é™åˆ¶
- æ‰¹é‡è®¾ç½®é™åˆ¶
- å…¨å±€ç¦ç”¨ç‰¹å®šç±»å‹
- è®¾ç½®æ–°ç¾¤é»˜è®¤é™åˆ¶
- æŸ¥çœ‹é™åˆ¶å†å²
- å¯¼å‡ºé™åˆ¶é…ç½®

**æ§åˆ¶ç²’åº¦**: æ¶ˆæ¯ç±»å‹çº§æ§åˆ¶

**å®ç°æ–¹å¼**:
- Echo Business Server ç»´æŠ¤é™åˆ¶é…ç½®
- åŒæ­¥åˆ° Echo DB çš„ `chat_banned_rights`
- å®¢æˆ·ç«¯æ ¹æ®æƒé™ç¦ç”¨å‘é€åŠŸèƒ½

**æ•°æ®æ¥æº**:
- Echo DB (è¯»å†™): `chats.default_banned_rights`
- Echo DB (è¯»å†™): `message_type_restrictions`

---

### 1ï¸âƒ£2ï¸âƒ£ ç³»ç»Ÿå¼€å…³ - ç´§æ€¥æ­¢è¡€

#### åå°å¿…é¡»èƒ½åšçš„

**ç³»ç»Ÿçº§å®‰å…¨å¼€å…³**:
```typescript
interface SystemEmergencyControls {
  // æ³¨å†Œæ§åˆ¶
  registrationEnabled: boolean;   // æ˜¯å¦å…è®¸æ–°æ³¨å†Œ
  inviteOnlyMode: boolean;        // ä»…é‚€è¯·æ¨¡å¼
  
  // åŠŸèƒ½æ§åˆ¶
  fileUploadEnabled: boolean;     // å…¨å±€æ–‡ä»¶ä¸Šä¼ 
  groupCreationEnabled: boolean;  // æ˜¯å¦å…è®¸åˆ›å»ºç¾¤
  channelCreationEnabled: boolean;// æ˜¯å¦å…è®¸åˆ›å»ºé¢‘é“
  
  // ç´§æ€¥æ¨¡å¼
  readOnlyMode: boolean;          // åªè¯»æ¨¡å¼ï¼ˆåªèƒ½æŸ¥çœ‹ï¼Œä¸èƒ½å‘é€ï¼‰
  maintenanceMode: boolean;       // ç»´æŠ¤æ¨¡å¼ï¼ˆæ‰€æœ‰åŠŸèƒ½æš‚åœï¼‰
  
  // æ¨é€æ§åˆ¶
  pushEnabled: boolean;           // å…¨å±€æ¨é€å¼€å…³
}
```


**æ“ä½œåŠŸèƒ½**:
- **å…³é—­æ–°æ³¨å†Œ**: ç¦æ­¢æ–°ç”¨æˆ·æ³¨å†Œ
- **ä»…é‚€è¯·æ¨¡å¼**: åªèƒ½é€šè¿‡é‚€è¯·ç æ³¨å†Œ
- **å…³é—­æ–‡ä»¶ä¸Šä¼ **: å…¨å±€ç¦æ­¢ä¸Šä¼ 
- **å…³é—­ç¾¤ç»„åˆ›å»º**: ç¦æ­¢åˆ›å»ºæ–°ç¾¤/é¢‘é“
- **åªè¯»æ¨¡å¼**: æ‰€æœ‰ç”¨æˆ·åªèƒ½æŸ¥çœ‹ï¼Œä¸èƒ½å‘é€
- **ç»´æŠ¤æ¨¡å¼**: æ‰€æœ‰åŠŸèƒ½æš‚åœï¼Œæ˜¾ç¤ºç»´æŠ¤å…¬å‘Š
- **å…³é—­æ¨é€**: å…¨å±€å…³é—­æ¨é€é€šçŸ¥

**ä½¿ç”¨åœºæ™¯**:
- é­å—æ”»å‡»æ—¶å¿«é€Ÿæ­¢è¡€
- ç³»ç»Ÿç»´æŠ¤æ—¶æš‚åœæœåŠ¡
- å†…å®¹äº‹æ•…æ—¶ç´§æ€¥æ§åˆ¶
- æœåŠ¡å™¨å‹åŠ›è¿‡å¤§æ—¶é™çº§

**æ§åˆ¶ç²’åº¦**: å¹³å°çº§

**æ•°æ®æ¥æº**:
- Echo DB: `system_controls`, `emergency_logs`

---

## ğŸŸ§ P1 åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 9ï¸âƒ£ é‚€è¯·ç³»ç»Ÿ - æ³¨å†Œé—¨æ§›

#### ä¸ºä»€ä¹ˆéœ€è¦é‚€è¯·ç³»ç»Ÿï¼Ÿ

Echo æ˜¯ç­›é€‰å‹äº§å“ï¼Œéœ€è¦æ§åˆ¶ç”¨æˆ·è´¨é‡å’Œå¢é•¿é€Ÿåº¦ã€‚

#### åå°å¿…é¡»èƒ½åšçš„

**é‚€è¯·ç ç®¡ç†**:
```typescript
interface InviteCodeManagement {
  // é‚€è¯·ç ç”Ÿæˆ
  generateCodes: {
    count: number;              // ç”Ÿæˆæ•°é‡
    expiresIn: number;          // æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰
    maxUses: number;            // æœ€å¤§ä½¿ç”¨æ¬¡æ•°
    note?: string;              // å¤‡æ³¨
  };
  
  // é‚€è¯·ç åˆ—è¡¨
  codes: {
    code: string;               // é‚€è¯·ç 
    createdBy: string;          // åˆ›å»ºè€…
    createdAt: Date;
    expiresAt: Date;
    maxUses: number;
    usedCount: number;
    status: 'active' | 'expired' | 'exhausted';
  }[];
  
  // é‚€è¯·é…é¢
  userQuotas: {
    userId: string;
    inviteQuota: number;        // å¯é‚€è¯·äººæ•°
    invitedCount: number;       // å·²é‚€è¯·äººæ•°
    successfulInvites: number;  // æˆåŠŸé‚€è¯·ï¼ˆå·²æ³¨å†Œï¼‰
  }[];
}
```

**é‚€è¯·å…³ç³»é“¾**:
```typescript
interface InviteRelationship {
  inviterId: string;            // é‚€è¯·äºº
  inviteeId: string;            // è¢«é‚€è¯·äºº
  inviteCode: string;           // ä½¿ç”¨çš„é‚€è¯·ç 
  invitedAt: Date;
  registeredAt?: Date;          // æ³¨å†Œæ—¶é—´
  status: 'pending' | 'registered' | 'active';
}
```

**æ“ä½œåŠŸèƒ½**:
- æ‰¹é‡ç”Ÿæˆé‚€è¯·ç 
- è®¾ç½®é‚€è¯·ç æœ‰æ•ˆæœŸå’Œä½¿ç”¨æ¬¡æ•°
- æŸ¥çœ‹é‚€è¯·ç ä½¿ç”¨æƒ…å†µ
- ç¦ç”¨/å¯ç”¨é‚€è¯·ç 
- è®¾ç½®ç”¨æˆ·é‚€è¯·é…é¢
- æŸ¥çœ‹é‚€è¯·å…³ç³»é“¾
- ç»Ÿè®¡é‚€è¯·æ•ˆæœï¼ˆè½¬åŒ–ç‡ã€æ´»è·ƒåº¦ï¼‰

**æ•°æ®æ¥æº**:
- Echo DB: `invite_codes`, `invite_relationships`, `user_quotas`

---

### ğŸ”Ÿ æƒé™è¾¹ç•Œ - ç¾¤ç»„æƒé™

#### åå°å¿…é¡»èƒ½åšçš„

**ç¾¤ç»„æƒé™æ§åˆ¶**:
```typescript
interface ChatPermissionBoundaries {
  chatId: string;
  
  // æ¶ˆæ¯æƒé™
  allowForward: boolean;        // æ˜¯å¦å…è®¸è½¬å‘
  allowLinks: boolean;          // æ˜¯å¦å…è®¸å‘é“¾æ¥
  allowMedia: boolean;          // æ˜¯å¦å…è®¸å‘åª’ä½“
  
  // æˆå‘˜æƒé™
  newMemberCanSpeak: boolean;   // æ–°æˆå‘˜æ˜¯å¦å¯å‘è¨€
  newMemberMuteHours: number;   // æ–°æˆå‘˜ç¦è¨€æ—¶é•¿
  
  // Bot æƒé™
  allowBots: boolean;           // æ˜¯å¦å…è®¸ Bot
  
  // åŒ¿åæƒé™
  allowAnonymous: boolean;      // æ˜¯å¦å…è®¸åŒ¿åç®¡ç†å‘˜
}
```

**æ“ä½œåŠŸèƒ½**:
- è®¾ç½®ç¾¤ç»„æ˜¯å¦å…è®¸è½¬å‘
- è®¾ç½®æ–°æˆå‘˜å‘è¨€é™åˆ¶
- è®¾ç½®æ˜¯å¦å…è®¸ Bot
- æ‰¹é‡åº”ç”¨æƒé™æ¨¡æ¿

**âš ï¸ æ³¨æ„**: è¿™æ˜¯å¯¹"æ˜¯å¦æ‰“æ‰°ç”¨æˆ·"çš„æ§åˆ¶æƒï¼Œä¸æ˜¯å¯¹æ¶ˆæ¯å†…å®¹çš„æ§åˆ¶

**æ•°æ®æ¥æº**:
- Echo DB: `chat_permission_boundaries`

---

### 1ï¸âƒ£1ï¸âƒ£ ç³»ç»Ÿæ¨é€ - éèŠå¤©æ¨é€ â­

#### ä¸èŠå¤©æ¨é€çš„åŒºåˆ«

| ç±»å‹ | èŠå¤©æ¨é€ | ç³»ç»Ÿæ¨é€ |
|------|---------|---------|
| æ¥æº | Telegram æ¶ˆæ¯ | Echo å¹³å° |
| å†…å®¹ | å®¢æˆ·ç«¯å®šä¹‰ | åå°å¯è‡ªå®šä¹‰ |
| æ§åˆ¶ | åªèƒ½æ§åˆ¶æ˜¯å¦å‘ç”Ÿ | å®Œå…¨å¯æ§ |
| é€šé“ | Echo æ¨é€ç³»ç»Ÿ | Echo æ¨é€é€šé“ |

#### åå°å¿…é¡»èƒ½åšçš„

**ç³»ç»Ÿæ¨é€ç±»å‹**:
```typescript
interface SystemPushNotification {
  type: 'announcement' | 'maintenance' | 'security' | 'invite' | 'system';
  
  // æ¨é€å†…å®¹ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
  title: string;
  body: string;
  icon?: string;
  
  // ç›®æ ‡ç”¨æˆ·
  targetType: 'all' | 'specific' | 'group';
  targetUsers?: string[];       // ç‰¹å®šç”¨æˆ·
  targetGroups?: string[];      // ç‰¹å®šç¾¤ç»„çš„æˆå‘˜
  
  // æ¨é€æ—¶é—´
  sendAt?: Date;                // å®šæ—¶æ¨é€
  
  // è·³è½¬
  action?: {
    type: 'url' | 'chat' | 'user';
    value: string;
  };
}
```

**ç³»ç»Ÿæ¨é€åœºæ™¯**:
1. **å¹³å°å…¬å‘Š**: æ–°åŠŸèƒ½ã€æ´»åŠ¨é€šçŸ¥
2. **ç³»ç»Ÿç»´æŠ¤**: ç»´æŠ¤é€šçŸ¥ã€æ¢å¤é€šçŸ¥
3. **å®‰å…¨æé†’**: å¼‚å¸¸ç™»å½•ã€å¯†ç ä¿®æ”¹
4. **é‚€è¯·æé†’**: é‚€è¯·ç åˆ°æœŸã€é…é¢æé†’
5. **æœåŠ¡å…¬å‘Š**: æœåŠ¡å‡çº§ã€æ”¿ç­–å˜æ›´

**æ“ä½œåŠŸèƒ½**:
- åˆ›å»ºç³»ç»Ÿæ¨é€
- é€‰æ‹©ç›®æ ‡ç”¨æˆ·ï¼ˆå…¨éƒ¨/ç‰¹å®š/ç¾¤ç»„ï¼‰
- è‡ªå®šä¹‰æ¨é€å†…å®¹
- å®šæ—¶å‘é€
- æŸ¥çœ‹æ¨é€å†å²å’Œé€è¾¾ç‡

**æ•°æ®æ¥æº**:
- Echo DB: `system_pushes`, `push_delivery_logs`

---

### 1ï¸âƒ£2ï¸âƒ£ æ•°æ®ç»Ÿè®¡ - åŸºç¡€æŒ‡æ ‡

#### åå°å¿…é¡»èƒ½åšçš„

**ç”¨æˆ·æŒ‡æ ‡**:
```typescript
interface UserMetrics {
  // åŸºç¡€æŒ‡æ ‡
  totalUsers: number;           // æ€»ç”¨æˆ·æ•°
  activeUsers: {
    dau: number;                // æ—¥æ´»
    wau: number;                // å‘¨æ´»
    mau: number;                // æœˆæ´»
  };
  
  // æ–°å¢ç”¨æˆ·
  newUsers: {
    today: number;
    thisWeek: number;
    thisMonth: number;
  };
  
  // ç•™å­˜ç‡
  retention: {
    day1: number;               // æ¬¡æ—¥ç•™å­˜
    day7: number;               // 7æ—¥ç•™å­˜
    day30: number;              // 30æ—¥ç•™å­˜
  };
}
```

**ç¾¤ç»„æŒ‡æ ‡**:
```typescript
interface ChatMetrics {
  totalChats: number;           // æ€»ç¾¤ç»„æ•°
  activeChats: number;          // æ´»è·ƒç¾¤ç»„æ•°
  
  // ç¾¤ç»„æ´»è·ƒåº¦
  chatActivity: {
    chatId: string;
    messageCount: number;       // æ¶ˆæ¯æ•°
    activeMembers: number;      // æ´»è·ƒæˆå‘˜æ•°
    growthRate: number;         // å¢é•¿ç‡
  }[];
}
```

**å†…å®¹æŒ‡æ ‡**:
```typescript
interface ContentMetrics {
  // æ¶ˆæ¯ç»Ÿè®¡
  totalMessages: number;
  messagesPerDay: number;
  
  // æ–‡ä»¶ç»Ÿè®¡
  totalFiles: number;
  storageUsed: number;          // å­˜å‚¨ä½¿ç”¨é‡ï¼ˆGBï¼‰
  
  // ä¸¾æŠ¥ç»Ÿè®¡
  totalReports: number;
  reportRate: number;           // ä¸¾æŠ¥ç‡
  resolvedReports: number;
}
```

**å°ç¦æŒ‡æ ‡**:
```typescript
interface ModerationMetrics {
  bannedUsers: number;
  frozenUsers: number;
  bannedChats: number;
  
  // å°ç¦è¶‹åŠ¿
  banTrend: {
    date: Date;
    count: number;
  }[];
}
```

**æ“ä½œåŠŸèƒ½**:
- æŸ¥çœ‹å®æ—¶æ•°æ®
- å¯¼å‡ºæ•°æ®æŠ¥è¡¨
- è®¾ç½®æ•°æ®å‘Šè­¦ï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰
- è‡ªå®šä¹‰æ—¶é—´èŒƒå›´

**æ•°æ®æ¥æº**:
- Echo DB (åªè¯»): èšåˆæŸ¥è¯¢
- Echo DB (è¯»å†™): `metrics_cache`, `daily_stats`

---

### 1ï¸âƒ£5ï¸âƒ£ éªŒè¯æ ‡è®°ç®¡ç†ï¼ˆè“Vï¼‰â­

#### Telegram å®¢æˆ·ç«¯çœŸå®å­˜åœ¨

```java
// TLRPC.User / TLRPC.Chat - çœŸå®å­—æ®µ
class User {
    boolean verified;       // éªŒè¯æ ‡è®°ï¼ˆè“Vï¼‰
}

class Chat {
    boolean verified;       // éªŒè¯æ ‡è®°
}
```

#### åå°å¿…é¡»èƒ½åšçš„

**éªŒè¯æ ‡è®°ç®¡ç†**:
```typescript
interface VerificationManagement {
  // éªŒè¯ç”¨æˆ·
  verifyUser(userId: string, verification: {
    reason: string;         // éªŒè¯åŸå› ï¼ˆå®˜æ–¹è´¦å·ã€çŸ¥åäººå£«ç­‰ï¼‰
    verifiedBy: string;
    note?: string;
  }): void;
  
  // éªŒè¯ç¾¤ç»„/é¢‘é“
  verifyChat(chatId: string, verification: {
    reason: string;         // éªŒè¯åŸå› ï¼ˆå®˜æ–¹ç¾¤ç»„ã€è®¤è¯ç»„ç»‡ç­‰ï¼‰
    verifiedBy: string;
    note?: string;
  }): void;
  
  // ç§»é™¤éªŒè¯
  removeVerification(id: string, type: 'user' | 'chat', reason: string): void;
  
  // æŸ¥çœ‹éªŒè¯å†å²
  getVerificationHistory(id: string, type: 'user' | 'chat'): VerificationRecord[];
  
  // éªŒè¯ç”³è¯·å®¡æ ¸
  reviewVerificationRequest(requestId: string, decision: 'approve' | 'reject', note: string): void;
}
```

**éªŒè¯è®°å½•**:
```typescript
interface VerificationRecord {
  verificationId: string;
  targetType: 'user' | 'chat';
  targetId: string;
  reason: string;
  verifiedBy: string;
  verifiedAt: Date;
  removedBy?: string;
  removedAt?: Date;
  removeReason?: string;
  status: 'active' | 'removed';
}
```

**æ“ä½œåŠŸèƒ½**:
- éªŒè¯ç”¨æˆ·/ç¾¤ç»„
- ç§»é™¤éªŒè¯
- å®¡æ ¸éªŒè¯ç”³è¯·
- æŸ¥çœ‹éªŒè¯å†å²
- æ‰¹é‡éªŒè¯
- å¯¼å‡ºéªŒè¯åˆ—è¡¨

**æ§åˆ¶ç²’åº¦**: æ ‡è®°çº§æ§åˆ¶

**å®ç°æ–¹å¼**:
- Echo Business Server ç»´æŠ¤éªŒè¯çŠ¶æ€
- åŒæ­¥åˆ° Echo DB çš„ `verified` å­—æ®µ
- å®¢æˆ·ç«¯æ˜¾ç¤ºè“Væ ‡è¯†

**æ•°æ®æ¥æº**:
- Echo DB (è¯»å†™): `users.verified`, `chats.verified`
- Echo DB (è¯»å†™): `verification_records`

---

### 1ï¸âƒ£6ï¸âƒ£ å…¬å¼€ç”¨æˆ·åç®¡ç† â­

#### Telegram å®¢æˆ·ç«¯çœŸå®å­˜åœ¨

```java
// TLRPC.User / TLRPC.Chat - çœŸå®å­—æ®µ
class User {
    String username;        // å…¬å¼€ç”¨æˆ·å @username
}

class Chat {
    String username;        // å…¬å¼€ç”¨æˆ·å @username
}
```

#### åå°å¿…é¡»èƒ½åšçš„

**å…¬å¼€ç”¨æˆ·åç®¡ç†**:
```typescript
interface UsernameManagement {
  // ç§»é™¤å…¬å¼€ç”¨æˆ·åï¼ˆå–æ¶ˆå…¬å¼€ï¼‰
  removePublicUsername(id: string, type: 'user' | 'chat', removal: {
    reason: string;
    removedBy: string;
    note?: string;
  }): void;
  
  // ä¿ç•™ç”¨æˆ·åï¼ˆé˜²æ­¢è¢«å ç”¨ï¼‰
  reserveUsername(username: string, reservation: {
    reason: string;
    reservedBy: string;
    expiresAt?: Date;
  }): void;
  
  // é‡Šæ”¾ä¿ç•™çš„ç”¨æˆ·å
  releaseReservedUsername(username: string, reason: string): void;
  
  // æŸ¥çœ‹ç”¨æˆ·åå†å²
  getUsernameHistory(id: string, type: 'user' | 'chat'): UsernameRecord[];
  
  // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å¯ç”¨
  checkUsernameAvailability(username: string): {
    available: boolean;
    reason?: string;
    reservedBy?: string;
  };
}
```

**ç”¨æˆ·åè®°å½•**:
```typescript
interface UsernameRecord {
  recordId: string;
  targetType: 'user' | 'chat';
  targetId: string;
  username: string;
  action: 'set' | 'removed' | 'reserved' | 'released';
  reason?: string;
  actionBy: string;
  actionAt: Date;
}
```

**æ“ä½œåŠŸèƒ½**:
- ç§»é™¤å…¬å¼€ç”¨æˆ·å
- ä¿ç•™ç”¨æˆ·å
- é‡Šæ”¾ä¿ç•™çš„ç”¨æˆ·å
- æŸ¥çœ‹ç”¨æˆ·åå†å²
- æ£€æŸ¥ç”¨æˆ·åå¯ç”¨æ€§
- æ‰¹é‡ä¿ç•™ç”¨æˆ·å
- å¯¼å‡ºç”¨æˆ·ååˆ—è¡¨

**æ§åˆ¶ç²’åº¦**: ç”¨æˆ·åçº§æ§åˆ¶

**å®ç°æ–¹å¼**:
- Echo Business Server ç»´æŠ¤ç”¨æˆ·åçŠ¶æ€
- åŒæ­¥åˆ° Echo DB çš„ `username` å­—æ®µ
- ç»´æŠ¤ä¿ç•™ç”¨æˆ·ååˆ—è¡¨

**æ•°æ®æ¥æº**:
- Echo DB (è¯»å†™): `users.username`, `chats.username`
- Echo DB (è¯»å†™): `username_records`, `reserved_usernames`

---

## ğŸŸ¨ P2 åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 1ï¸âƒ£7ï¸âƒ£ åœˆå­/æ ‡ç­¾ - å…´è¶£åˆ†ç±»

#### åŸºäº Telegram ç¾¤ç»„çš„æ ‡ç­¾ç³»ç»Ÿ

**æ ‡ç­¾ç®¡ç†**:
```typescript
interface CircleTagSystem {
  // æ ‡ç­¾å®šä¹‰
  tags: {
    id: string;
    name: string;               // æ ‡ç­¾åï¼ˆå¦‚ tech, art, privateï¼‰
    displayName: string;        // æ˜¾ç¤ºåç§°
    description: string;
    icon?: string;
    color?: string;
  }[];
  
  // ç¾¤ç»„æ ‡ç­¾
  chatTags: {
    chatId: string;
    tags: string[];             // æ ‡ç­¾ ID åˆ—è¡¨
    assignedBy: string;         // åˆ†é…è€…
    assignedAt: Date;
  }[];
}
```

**æ“ä½œåŠŸèƒ½**:
- åˆ›å»º/ç¼–è¾‘æ ‡ç­¾
- ä¸ºç¾¤ç»„åˆ†é…æ ‡ç­¾
- æŒ‰æ ‡ç­¾ç­›é€‰ç¾¤ç»„
- æ ‡ç­¾ç»Ÿè®¡ï¼ˆç¾¤ç»„æ•°ã€æ´»è·ƒåº¦ï¼‰

**ç”¨é€”**: æœªæ¥åš"æ¨è/å¹¿åœº"çš„åŸºç¡€

**æ•°æ®æ¥æº**:
- Echo DB: `circle_tags`, `chat_tags`

---

### 1ï¸âƒ£8ï¸âƒ£ å¹¿åœº/æ¨è - å†…å®¹èšåˆ

#### ä¸å¹²æ‰° IM çš„æ¨èç³»ç»Ÿ

**æ¨èæœºåˆ¶**:
```typescript
interface RecommendationSystem {
  // æ¨èå†…å®¹
  recommendations: {
    type: 'chat' | 'channel' | 'message';
    targetId: string;
    title: string;
    description: string;
    tags: string[];
    
    // æ¨èæƒé‡
    weight: number;             // æ‰‹åŠ¨è®¾ç½®
    hotScore: number;           // çƒ­åº¦åˆ†æ•°
    
    // çŠ¶æ€
    status: 'active' | 'hidden';
    publishedAt: Date;
  }[];
  
  // çƒ­åº¦è®¡ç®—
  hotScoreFactors: {
    messageCount: number;       // æ¶ˆæ¯æ•°
    memberGrowth: number;       // æˆå‘˜å¢é•¿
    forwardCount: number;       // è½¬å‘æ•°
    replyCount: number;         // å›å¤æ•°
  };
}
```

**æ“ä½œåŠŸèƒ½**:
- æ‰‹åŠ¨æ¨èç¾¤ç»„/é¢‘é“
- è®¾ç½®æ¨èæƒé‡
- ä¸‹æ¶æ¨è
- æŒ‰æ ‡ç­¾æ¨è
- æŸ¥çœ‹æ¨èæ•ˆæœï¼ˆç‚¹å‡»ç‡ã€åŠ å…¥ç‡ï¼‰

**âš ï¸ é‡ç‚¹**: å¹¿åœºæ˜¯"å†…å®¹å±‚"ï¼ŒIM æ˜¯"é€šä¿¡å±‚"â€”â€”ä¸¥æ ¼åˆ†ç¦»

**æ•°æ®æ¥æº**:
- Echo DB: `recommendations`, `hot_scores`, `recommendation_clicks`

---

### 1ï¸âƒ£9ï¸âƒ£ å†…å®¹èšåˆ - ç²¾é€‰æ¶ˆæ¯

#### åªè¯»çš„å†…å®¹èšåˆ

**ç²¾é€‰å†…å®¹**:
```typescript
interface FeaturedContent {
  collectionId: string;
  title: string;
  description: string;
  
  // ç²¾é€‰æ¶ˆæ¯ï¼ˆåªè½¬å‘ï¼Œä¸ä¿®æ”¹ï¼‰
  messages: {
    messageId: string;
    chatId: string;
    forwardedAt: Date;
  }[];
  
  status: 'draft' | 'published' | 'archived';
}
```

**æ“ä½œåŠŸèƒ½**:
- åˆ›å»ºç²¾é€‰åˆé›†
- æ·»åŠ æ¶ˆæ¯åˆ°åˆé›†ï¼ˆé€šè¿‡è½¬å‘ï¼‰
- å‘å¸ƒ/ä¸‹æ¶åˆé›†
- ä¸ä¿®æ”¹åŸæ¶ˆæ¯

**æ•°æ®æ¥æº**:
- Echo DB: `featured_collections`, `featured_messages`

---

## ğŸŸ© P3 åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 2ï¸âƒ£0ï¸âƒ£ Bot ç®¡ç† - æœºå™¨äººæ§åˆ¶

#### Telegram Bot çœŸå®å­˜åœ¨

**Bot æ§åˆ¶**:
```typescript
interface BotManagement {
  // Bot ç™½åå•
  allowedBots: {
    botId: string;
    botUsername: string;
    allowedChats: string[];     // å…è®¸ä½¿ç”¨çš„ç¾¤ç»„
    permissions: string[];      // æƒé™åˆ—è¡¨
  }[];
  
  // å…¨å±€è®¾ç½®
  botsEnabled: boolean;         // æ˜¯å¦å…è®¸ Bot
  requireApproval: boolean;     // Bot éœ€è¦å®¡æ‰¹
}
```

**æ“ä½œåŠŸèƒ½**:
- å…è®¸/ç¦æ­¢ Bot
- è®¾ç½® Bot ç™½åå•
- é™åˆ¶ Bot ä½¿ç”¨èŒƒå›´

**æ•°æ®æ¥æº**:
- Echo DB: `bot_whitelist`, `bot_permissions`

---

### 2ï¸âƒ£1ï¸âƒ£ åæ»¥ç”¨è‡ªåŠ¨åŒ– - è¡Œä¸ºæ£€æµ‹

#### ä¸çœ‹å†…å®¹çš„è¡Œä¸ºæ£€æµ‹

**è‡ªåŠ¨åŒ–è§„åˆ™**:
```typescript
interface AntiAbuseRules {
  // æ³¨å†Œé¢‘ç‡
  registrationRateLimit: {
    maxPerIP: number;           // å• IP æ³¨å†Œä¸Šé™
    timeWindow: number;         // æ—¶é—´çª—å£ï¼ˆå°æ—¶ï¼‰
  };
  
  // ç¾¤åˆ›å»ºé¢‘ç‡
  groupCreationRateLimit: {
    maxPerUser: number;
    timeWindow: number;
  };
  
  // æ–‡ä»¶ä¸Šä¼ é¢‘ç‡
  fileUploadRateLimit: {
    maxPerUser: number;
    maxSizePerDay: number;      // æ¯æ—¥ä¸Šä¼ å¤§å°ä¸Šé™
  };
  
  // è‡ªåŠ¨å¤„ç†
  autoActions: {
    trigger: string;            // è§¦å‘æ¡ä»¶
    action: 'warn' | 'freeze' | 'ban';
    duration?: number;          // æŒç»­æ—¶é—´
  }[];
}
```

**æ•°æ®æ¥æº**:
- Echo DB: `abuse_rules`, `abuse_detections`, `auto_actions`

---

### 2ï¸âƒ£2ï¸âƒ£ å¤šèŠ‚ç‚¹/ç¾å¤‡ - é«˜å¯ç”¨

**èŠ‚ç‚¹ç®¡ç†**:
```typescript
interface NodeManagement {
  nodes: {
    nodeId: string;
    type: 'gateway' | 'session' | 'bff';
    status: 'online' | 'offline' | 'maintenance';
    load: number;               // è´Ÿè½½
    connections: number;        // è¿æ¥æ•°
  }[];
  
  // æµé‡åˆ‡æ¢
  trafficRouting: {
    enabled: boolean;
    strategy: 'round-robin' | 'least-connections' | 'weighted';
  };
}
```

---

### 2ï¸âƒ£3ï¸âƒ£ åˆè§„å·¥å…· - æ³•å¾‹å“åº”

**åˆè§„åŠŸèƒ½**:
```typescript
interface ComplianceTools {
  // æ•°æ®å¯¼å‡º
  dataExport: {
    userId: string;
    requestedAt: Date;
    status: 'pending' | 'processing' | 'completed';
    downloadUrl?: string;
  }[];
  
  // æ•°æ®åˆ é™¤
  dataDeletion: {
    userId: string;
    requestedAt: Date;
    scheduledAt: Date;
    status: 'pending' | 'scheduled' | 'completed';
  }[];
}
```

---

## ğŸ“ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•°æ®åº“è®¾è®¡

**Echo Business DB (PostgreSQL)**:

```sql
-- ç”¨æˆ·çŠ¶æ€è¡¨
CREATE TABLE user_status (
  user_id VARCHAR(255) PRIMARY KEY,
  status VARCHAR(20) NOT NULL,  -- normal, frozen, banned
  risk_level VARCHAR(20),
  banned_at TIMESTAMP,
  banned_by VARCHAR(255),
  ban_reason TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- æ¨é€æ§åˆ¶è¡¨
CREATE TABLE push_controls (
  id SERIAL PRIMARY KEY,
  entity_type VARCHAR(20) NOT NULL,  -- user, chat, global
  entity_id VARCHAR(255),
  push_enabled BOOLEAN DEFAULT TRUE,
  max_push_per_hour INTEGER,
  reason TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ä¸¾æŠ¥è¡¨
CREATE TABLE reports (
  id SERIAL PRIMARY KEY,
  report_type VARCHAR(20) NOT NULL,  -- message, user, chat
  reported_by VARCHAR(255) NOT NULL,
  reported_target VARCHAR(255) NOT NULL,
  reason VARCHAR(50),
  description TEXT,
  message_id VARCHAR(255),
  chat_id VARCHAR(255),
  status VARCHAR(20) DEFAULT 'pending',
  handled_by VARCHAR(255),
  handled_at TIMESTAMP,
  action VARCHAR(20),
  note TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- é‚€è¯·ç è¡¨
CREATE TABLE invite_codes (
  code VARCHAR(50) PRIMARY KEY,
  created_by VARCHAR(255),
  expires_at TIMESTAMP,
  max_uses INTEGER DEFAULT 1,
  used_count INTEGER DEFAULT 0,
  status VARCHAR(20) DEFAULT 'active',
  note TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç³»ç»Ÿæ¨é€è¡¨
CREATE TABLE system_pushes (
  id SERIAL PRIMARY KEY,
  type VARCHAR(20) NOT NULL,
  title VARCHAR(255) NOT NULL,
  body TEXT NOT NULL,
  target_type VARCHAR(20) NOT NULL,
  target_users TEXT[],
  send_at TIMESTAMP,
  sent_at TIMESTAMP,
  delivery_count INTEGER DEFAULT 0,
  created_by VARCHAR(255),
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç³»ç»Ÿæ§åˆ¶è¡¨
CREATE TABLE system_controls (
  key VARCHAR(50) PRIMARY KEY,
  value BOOLEAN NOT NULL,
  updated_by VARCHAR(255),
  updated_at TIMESTAMP DEFAULT NOW()
);
```


### API è®¾è®¡

**RESTful API ç»“æ„**:

```
echo-business-server/
â”œâ”€â”€ /api/admin/
â”‚   â”œâ”€â”€ /users
â”‚   â”‚   â”œâ”€â”€ GET    /               # ç”¨æˆ·åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ GET    /:id            # ç”¨æˆ·è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ POST   /:id/freeze     # å†»ç»“ç”¨æˆ·
â”‚   â”‚   â”œâ”€â”€ POST   /:id/ban        # å°ç¦ç”¨æˆ·
â”‚   â”‚   â”œâ”€â”€ POST   /:id/unban      # è§£å°ç”¨æˆ·
â”‚   â”‚   â””â”€â”€ POST   /:id/logout-all # å¼ºåˆ¶ç™»å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ /chats
â”‚   â”‚   â”œâ”€â”€ GET    /               # ç¾¤ç»„åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ GET    /:id            # ç¾¤ç»„è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ POST   /:id/ban        # å°ç¦ç¾¤ç»„
â”‚   â”‚   â”œâ”€â”€ POST   /:id/dissolve   # è§£æ•£ç¾¤ç»„
â”‚   â”‚   â””â”€â”€ POST   /:id/unban      # è§£å°ç¾¤ç»„
â”‚   â”‚
â”‚   â”œâ”€â”€ /files
â”‚   â”‚   â”œâ”€â”€ GET    /controls       # æ–‡ä»¶æ§åˆ¶ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ PUT    /controls       # æ›´æ–°ç­–ç•¥
â”‚   â”‚   â””â”€â”€ POST   /controls/emergency # ç´§æ€¥å…³é—­
â”‚   â”‚
â”‚   â”œâ”€â”€ /push
â”‚   â”‚   â”œâ”€â”€ GET    /controls       # æ¨é€æ§åˆ¶åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ PUT    /controls/:id   # æ›´æ–°æ¨é€æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ POST   /emergency-stop # ç´§æ€¥å…³é—­æ¨é€
â”‚   â”‚   â””â”€â”€ POST   /system-push    # å‘é€ç³»ç»Ÿæ¨é€
â”‚   â”‚
â”‚   â”œâ”€â”€ /reports
â”‚   â”‚   â”œâ”€â”€ GET    /               # ä¸¾æŠ¥åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ GET    /:id            # ä¸¾æŠ¥è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ POST   /:id/handle     # å¤„ç†ä¸¾æŠ¥
â”‚   â”‚   â””â”€â”€ POST   /:id/dismiss    # é©³å›ä¸¾æŠ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ /invites
â”‚   â”‚   â”œâ”€â”€ GET    /codes          # é‚€è¯·ç åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ POST   /codes/generate # ç”Ÿæˆé‚€è¯·ç 
â”‚   â”‚   â”œâ”€â”€ PUT    /codes/:code    # æ›´æ–°é‚€è¯·ç 
â”‚   â”‚   â””â”€â”€ GET    /relationships  # é‚€è¯·å…³ç³»é“¾
â”‚   â”‚
â”‚   â”œâ”€â”€ /system
â”‚   â”‚   â”œâ”€â”€ GET    /controls       # ç³»ç»Ÿå¼€å…³çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ PUT    /controls       # æ›´æ–°ç³»ç»Ÿå¼€å…³
â”‚   â”‚   â””â”€â”€ POST   /emergency      # ç´§æ€¥æ¨¡å¼
â”‚   â”‚
â”‚   â””â”€â”€ /metrics
â”‚       â”œâ”€â”€ GET    /users          # ç”¨æˆ·æŒ‡æ ‡
â”‚       â”œâ”€â”€ GET    /chats          # ç¾¤ç»„æŒ‡æ ‡
â”‚       â”œâ”€â”€ GET    /content        # å†…å®¹æŒ‡æ ‡
â”‚       â””â”€â”€ GET    /moderation     # å°ç¦æŒ‡æ ‡
```

---

## ğŸ¨ å‰ç«¯é¡µé¢ç»“æ„

### ç®¡ç†åå°é¡µé¢

```
Echo Admin Panel/
â”œâ”€â”€ ğŸ“Š Dashboard (ä»ªè¡¨ç›˜)
â”‚   â”œâ”€â”€ å®æ—¶æ•°æ®æ¦‚è§ˆ
â”‚   â”œâ”€â”€ å…³é”®æŒ‡æ ‡å¡ç‰‡
â”‚   â””â”€â”€ å‘Šè­¦é€šçŸ¥
â”‚
â”œâ”€â”€ ğŸ‘¥ User Management (ç”¨æˆ·ç®¡ç†)
â”‚   â”œâ”€â”€ ç”¨æˆ·åˆ—è¡¨
â”‚   â”œâ”€â”€ ç”¨æˆ·è¯¦æƒ…
â”‚   â”œâ”€â”€ å°ç¦è®°å½•
â”‚   â””â”€â”€ é£é™©ç”¨æˆ·
â”‚
â”œâ”€â”€ ğŸ’¬ Chat Management (å¯¹è¯ç®¡ç†)
â”‚   â”œâ”€â”€ ç¾¤ç»„åˆ—è¡¨
â”‚   â”œâ”€â”€ é¢‘é“åˆ—è¡¨
â”‚   â”œâ”€â”€ ç¾¤ç»„è¯¦æƒ…
â”‚   â””â”€â”€ å°ç¦è®°å½•
â”‚
â”œâ”€â”€ ğŸ“ File Control (æ–‡ä»¶æ§åˆ¶)
â”‚   â”œâ”€â”€ æ§åˆ¶ç­–ç•¥
â”‚   â”œâ”€â”€ ä¸Šä¼ ç»Ÿè®¡
â”‚   â””â”€â”€ å­˜å‚¨ç®¡ç†
â”‚
â”œâ”€â”€ ğŸ”” Push Control (æ¨é€æ§åˆ¶)
â”‚   â”œâ”€â”€ æ¨é€å¼€å…³
â”‚   â”œâ”€â”€ ç”¨æˆ·æ¨é€æ§åˆ¶
â”‚   â”œâ”€â”€ ç¾¤ç»„æ¨é€æ§åˆ¶
â”‚   â”œâ”€â”€ ç³»ç»Ÿæ¨é€
â”‚   â””â”€â”€ æ¨é€æ—¥å¿—
â”‚
â”œâ”€â”€ ğŸš¨ Reports (ä¸¾æŠ¥ç®¡ç†)
â”‚   â”œâ”€â”€ å¾…å¤„ç†ä¸¾æŠ¥
â”‚   â”œâ”€â”€ å·²å¤„ç†ä¸¾æŠ¥
â”‚   â””â”€â”€ å¤„ç†ç»Ÿè®¡
â”‚
â”œâ”€â”€ ğŸ« Invites (é‚€è¯·ç³»ç»Ÿ)
â”‚   â”œâ”€â”€ é‚€è¯·ç ç®¡ç†
â”‚   â”œâ”€â”€ é‚€è¯·å…³ç³»é“¾
â”‚   â””â”€â”€ é‚€è¯·ç»Ÿè®¡
â”‚
â”œâ”€â”€ âš™ï¸ System (ç³»ç»Ÿè®¾ç½®)
â”‚   â”œâ”€â”€ ç³»ç»Ÿå¼€å…³
â”‚   â”œâ”€â”€ ç´§æ€¥æ§åˆ¶
â”‚   â””â”€â”€ æ“ä½œæ—¥å¿—
â”‚
â””â”€â”€ ğŸ“ˆ Analytics (æ•°æ®åˆ†æ)
    â”œâ”€â”€ ç”¨æˆ·åˆ†æ
    â”œâ”€â”€ ç¾¤ç»„åˆ†æ
    â”œâ”€â”€ å†…å®¹åˆ†æ
    â””â”€â”€ è‡ªå®šä¹‰æŠ¥è¡¨
```

---

## ğŸ” æƒé™è®¾è®¡

### ç®¡ç†å‘˜è§’è‰²

```typescript
interface AdminRole {
  role: 'super_admin' | 'admin' | 'moderator' | 'viewer';
  
  permissions: {
    // ç”¨æˆ·ç®¡ç†
    canViewUsers: boolean;
    canFreezeUsers: boolean;
    canBanUsers: boolean;
    
    // å¯¹è¯ç®¡ç†
    canViewChats: boolean;
    canBanChats: boolean;
    canDissolveChats: boolean;
    
    // æ–‡ä»¶æ§åˆ¶
    canControlFiles: boolean;
    
    // æ¨é€æ§åˆ¶
    canControlPush: boolean;
    canSendSystemPush: boolean;
    
    // ä¸¾æŠ¥å¤„ç†
    canViewReports: boolean;
    canHandleReports: boolean;
    
    // é‚€è¯·ç³»ç»Ÿ
    canManageInvites: boolean;
    
    // ç³»ç»Ÿæ§åˆ¶
    canControlSystem: boolean;
    canUseEmergency: boolean;
    
    // æ•°æ®åˆ†æ
    canViewAnalytics: boolean;
    canExportData: boolean;
  };
}
```

**è§’è‰²æƒé™çŸ©é˜µ**:

| åŠŸèƒ½ | Super Admin | Admin | Moderator | Viewer |
|------|-------------|-------|-----------|--------|
| æŸ¥çœ‹ç”¨æˆ· | âœ… | âœ… | âœ… | âœ… |
| å†»ç»“ç”¨æˆ· | âœ… | âœ… | âœ… | âŒ |
| å°ç¦ç”¨æˆ· | âœ… | âœ… | âŒ | âŒ |
| è§£æ•£ç¾¤ç»„ | âœ… | âœ… | âŒ | âŒ |
| æ–‡ä»¶æ§åˆ¶ | âœ… | âœ… | âœ… | âŒ |
| æ¨é€æ§åˆ¶ | âœ… | âœ… | âœ… | âŒ |
| å¤„ç†ä¸¾æŠ¥ | âœ… | âœ… | âœ… | âŒ |
| é‚€è¯·ç®¡ç† | âœ… | âœ… | âŒ | âŒ |
| ç³»ç»Ÿæ§åˆ¶ | âœ… | âœ… | âŒ | âŒ |
| ç´§æ€¥å¼€å…³ | âœ… | âŒ | âŒ | âŒ |
| æ•°æ®å¯¼å‡º | âœ… | âœ… | âŒ | âŒ |

---

## ğŸš€ å®æ–½è·¯çº¿å›¾

### Phase 1: P0 æ ¸å¿ƒåŠŸèƒ½ï¼ˆ3-4 å‘¨ï¼‰

**Week 1-2**:
- âœ… ç”¨æˆ·ç®¡ç†ï¼ˆåˆ—è¡¨ã€è¯¦æƒ…ã€å°ç¦ï¼‰
- âœ… é£æ§ç³»ç»Ÿï¼ˆIP/è®¾å¤‡å°ç¦ï¼‰
- âœ… å¯¹è¯ç®¡ç†ï¼ˆç¾¤ç»„åˆ—è¡¨ã€å°ç¦ã€è§£æ•£ï¼‰
- âœ… **è¯ˆéª—/è™šå‡æ ‡è®°** â­ (æ–°å¢)

**Week 3**:
- âœ… æ–‡ä»¶æ§åˆ¶ï¼ˆä¸Šä¼ å¼€å…³ã€ç±»å‹é™åˆ¶ï¼‰
- âœ… æœç´¢æ§åˆ¶ï¼ˆå¯å‘ç°æ€§ï¼‰
- âœ… ä¸¾æŠ¥ç®¡ç†ï¼ˆåˆ—è¡¨ã€å¤„ç†ï¼‰
- âœ… **æ¶ˆæ¯ç±»å‹æ§åˆ¶** â­ (æ–°å¢)

**Week 4**:
- âœ… æ¨é€æ§åˆ¶ï¼ˆæ€»å¼€å…³ã€ç”¨æˆ·çº§ã€ç¾¤ç»„çº§ï¼‰
- âœ… ç³»ç»Ÿå¼€å…³ï¼ˆç´§æ€¥æ§åˆ¶ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- å¯ä»¥å°ç¦/è§£å°ç”¨æˆ·
- å¯ä»¥è§£æ•£/å°ç¦ç¾¤ç»„
- å¯ä»¥å…³é—­æ–‡ä»¶ä¸Šä¼ 
- å¯ä»¥å¤„ç†ä¸¾æŠ¥
- **å¯ä»¥æ§åˆ¶æ¨é€æ˜¯å¦å‘ç”Ÿ**
- **å¯ä»¥æ ‡è®°è¯ˆéª—/è™šå‡ç”¨æˆ·å’Œç¾¤ç»„** â­
- **å¯ä»¥æŒ‰ç¾¤ç»„æ§åˆ¶æ¶ˆæ¯ç±»å‹** â­
- å¯ä»¥ä¸€é”®ç´§æ€¥æ­¢è¡€

---

### Phase 2: P1 å·®å¼‚åŒ–åŠŸèƒ½ï¼ˆ2-3 å‘¨ï¼‰

**Week 5**:
- âœ… é‚€è¯·ç³»ç»Ÿï¼ˆé‚€è¯·ç ç”Ÿæˆã€ç®¡ç†ï¼‰
- âœ… æƒé™è¾¹ç•Œï¼ˆç¾¤ç»„æƒé™æ§åˆ¶ï¼‰
- âœ… **éªŒè¯æ ‡è®°ç®¡ç†** â­ (æ–°å¢)

**Week 6**:
- âœ… ç³»ç»Ÿæ¨é€ï¼ˆéèŠå¤©æ¨é€ï¼‰
- âœ… æ•°æ®ç»Ÿè®¡ï¼ˆDAU/MAUã€åŸºç¡€æŒ‡æ ‡ï¼‰
- âœ… **ç”¨æˆ·åç®¡ç†** â­ (æ–°å¢)

**éªŒæ”¶æ ‡å‡†**:
- å¯ä»¥ç”Ÿæˆå’Œç®¡ç†é‚€è¯·ç 
- å¯ä»¥è®¾ç½®ç¾¤ç»„æƒé™è¾¹ç•Œ
- å¯ä»¥å‘é€ç³»ç»Ÿæ¨é€
- å¯ä»¥æŸ¥çœ‹åŸºç¡€æ•°æ®æŒ‡æ ‡
- **å¯ä»¥éªŒè¯ç”¨æˆ·/ç¾¤ç»„ï¼ˆè“Vï¼‰** â­
- **å¯ä»¥ä¿ç•™/ç§»é™¤å…¬å¼€ç”¨æˆ·å** â­

---

### Phase 3: P2 è¿è¥æ‰©å±•ï¼ˆ2 å‘¨ï¼‰

**Week 7**:
- âœ… åœˆå­/æ ‡ç­¾ç³»ç»Ÿ
- âœ… å¹¿åœº/æ¨è

**Week 8**:
- âœ… å†…å®¹èšåˆ
- âœ… æ¨èç®—æ³•ä¼˜åŒ–

---

### Phase 4: P3 é•¿æœŸè§„åˆ’ï¼ˆæŒ‰éœ€ï¼‰

- Bot ç®¡ç†
- åæ»¥ç”¨è‡ªåŠ¨åŒ–
- å¤šèŠ‚ç‚¹/ç¾å¤‡
- åˆè§„å·¥å…·

---

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### æ¶æ„æ£€æŸ¥

- [ ] Echo Business Server ç‹¬ç«‹éƒ¨ç½²
- [ ] ä½¿ç”¨ç‹¬ç«‹çš„ PostgreSQL æ•°æ®åº“
- [ ] Echo DB åªè¯»è®¿é—®
- [ ] é€šè¿‡äº‹ä»¶/gRPC ä¸ Echo é€šä¿¡
- [ ] ä¸šåŠ¡å±‚æ•…éšœä¸å½±å“ IM æ ¸å¿ƒ

### åŠŸèƒ½æ£€æŸ¥

**P0 åŠŸèƒ½**:
- [ ] ç”¨æˆ·ç®¡ç†ï¼ˆå°ç¦ã€å†»ç»“ã€å¼ºåˆ¶ç™»å‡ºï¼‰
- [ ] é£æ§ç³»ç»Ÿï¼ˆIP/è®¾å¤‡å°ç¦ï¼‰
- [ ] å¯¹è¯ç®¡ç†ï¼ˆè§£æ•£ç¾¤ã€å°ç¦ç¾¤ï¼‰
- [ ] æ–‡ä»¶æ§åˆ¶ï¼ˆä¸Šä¼ å¼€å…³ï¼‰
- [ ] æœç´¢æ§åˆ¶ï¼ˆå¯å‘ç°æ€§ï¼‰
- [ ] ä¸¾æŠ¥ç®¡ç†ï¼ˆå¤„ç†ä¸¾æŠ¥ï¼‰
- [ ] **æ¨é€æ§åˆ¶ï¼ˆæ€»å¼€å…³ã€ç”¨æˆ·çº§ã€ç¾¤ç»„çº§ã€é£æ§ï¼‰** â­
- [ ] **è¯ˆéª—/è™šå‡æ ‡è®°ï¼ˆç”¨æˆ·å’Œç¾¤ç»„æ ‡è®°ç®¡ç†ï¼‰** â­
- [ ] **æ¶ˆæ¯ç±»å‹æ§åˆ¶ï¼ˆæŒ‰ç¾¤ç»„ç¦ç”¨ç‰¹å®šç±»å‹ï¼‰** â­
- [ ] ç³»ç»Ÿå¼€å…³ï¼ˆç´§æ€¥æ­¢è¡€ï¼‰

**P1 åŠŸèƒ½**:
- [ ] é‚€è¯·ç³»ç»Ÿ
- [ ] æƒé™è¾¹ç•Œ
- [ ] ç³»ç»Ÿæ¨é€
- [ ] æ•°æ®ç»Ÿè®¡
- [ ] **éªŒè¯æ ‡è®°ï¼ˆè“Vç®¡ç†ï¼‰** â­
- [ ] **ç”¨æˆ·åç®¡ç†ï¼ˆä¿ç•™/ç§»é™¤å…¬å¼€ç”¨æˆ·åï¼‰** â­

### æ¨é€åŠŸèƒ½ä¸“é¡¹æ£€æŸ¥ â­

- [ ] å…¨å±€æ¨é€å¼€å…³å¯ç”¨
- [ ] ç”¨æˆ·çº§æ¨é€æ§åˆ¶å¯ç”¨
- [ ] ç¾¤ç»„çº§æ¨é€æ§åˆ¶å¯ç”¨
- [ ] æ¨é€é¢‘ç‡é™åˆ¶ç”Ÿæ•ˆ
- [ ] ç´§æ€¥ç†”æ–­åŠŸèƒ½å¯ç”¨
- [ ] ç³»ç»Ÿæ¨é€ï¼ˆéèŠå¤©ï¼‰å¯å‘é€
- [ ] æ¨é€æ—¥å¿—å®Œæ•´è®°å½•
- [ ] **ä¸è‡ªå®šä¹‰èŠå¤©æ¨é€æ–‡æ¡ˆ**
- [ ] **ä¸ç»•è¿‡ Telegram æ¨é€ç³»ç»Ÿ**
- [ ] **åªæ§åˆ¶æ¨é€æ˜¯å¦å‘ç”Ÿï¼Œä¸æ§åˆ¶å†…å®¹**

### å®‰å…¨æ£€æŸ¥

- [ ] ç®¡ç†å‘˜æƒé™æ§åˆ¶
- [ ] æ“ä½œæ—¥å¿—è®°å½•
- [ ] æ•æ„Ÿæ“ä½œäºŒæ¬¡ç¡®è®¤
- [ ] API è®¿é—®é‰´æƒ
- [ ] æ•°æ®è„±æ•æ˜¾ç¤º

### æ€§èƒ½æ£€æŸ¥

- [ ] ç”¨æˆ·åˆ—è¡¨åˆ†é¡µåŠ è½½
- [ ] ç¾¤ç»„åˆ—è¡¨åˆ†é¡µåŠ è½½
- [ ] æ•°æ®ç»Ÿè®¡ä½¿ç”¨ç¼“å­˜
- [ ] å¤§é‡æ“ä½œä½¿ç”¨é˜Ÿåˆ—
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

---

## âœ… æ€»ç»“

### æ ¸å¿ƒåŸåˆ™ï¼ˆå¿…é¡»éµå®ˆï¼‰

1. **æ§åˆ¶"æƒåŠ›è¾¹ç•Œ"ï¼Œä¸æ˜¯"åŠŸèƒ½ç»†èŠ‚"**
2. **Echo ä¸æ§åˆ¶"æ¨é€è¯´ä»€ä¹ˆ"ï¼Œåªæ§åˆ¶"æ¨é€ä¼šä¸ä¼šå‘ç”Ÿ"** â­
3. **è¢«åŠ¨æ²»ç†ï¼Œä¸ä¸»åŠ¨æ‰«æ**
4. **è¡Œä¸ºå±‚æ§åˆ¶ï¼Œä¸ç¢°åŠ å¯†å†…å®¹**
5. **å¹³å°çº§å¼€å…³ï¼Œç´§æ€¥æ­¢è¡€**

### ä¸‰æ¡ç”Ÿå­˜çº¿ï¼ˆP0 æ ¸å¿ƒï¼‰â­â­â­

1. **æœç´¢ä¸å¯å‘ç°æ€§æ˜¯ P0** - ä¸åšå°±ä¼šå¤±æ§ï¼ˆåƒåœ¾å·ã€é»‘äº§ã€éªšæ‰°ï¼‰
2. **ä¼šè¯å¼ºåˆ¶ç™»å‡ºæ˜¯ P0** - ä¸åšå°±æ²¡æ³•çœŸæ­£å°ç¦/æ­¢è¡€
3. **åå°åªç®¡"æ¨é€æ˜¯å¦å‘ç”Ÿ"ï¼Œä¸ç¢°"èŠå¤©æ¨é€å†…å®¹"** - ä¿æŒ Telegram ä½“éªŒ

### æ¨é€æ§åˆ¶æ ¸å¿ƒè¦ç‚¹ â­â­â­

**å¿…é¡»åšçš„**:
- âœ… æ§åˆ¶æ¨é€æ˜¯å¦å‘ç”Ÿ
- âœ… ç”¨æˆ·çº§æ¨é€èµ„æ ¼æ§åˆ¶
- âœ… ç¾¤ç»„çº§æ¨é€è®¸å¯
- âœ… æ¨é€é¢‘ç‡é£æ§
- âœ… å…¨å±€æ¨é€å¼€å…³
- âœ… ç³»ç»Ÿæ¨é€ï¼ˆéèŠå¤©ï¼‰å¯è‡ªå®šä¹‰

**ä¸èƒ½åšçš„**:
- âŒ è‡ªå®šä¹‰èŠå¤©æ¨é€æ–‡æ¡ˆ
- âŒ åˆ†ææ¶ˆæ¯å†…å®¹å†³å®šæ¨é€
- âŒ ç»•è¿‡ Telegram æ¨é€ç³»ç»Ÿ

### åŠŸèƒ½ä¼˜å…ˆçº§

**ç«‹å³å®æ–½ (P0) - 12é¡¹ç”Ÿå­˜çº§åŠŸèƒ½**:
1. ç”¨æˆ·ç®¡ç†
2. é£æ§ç³»ç»Ÿ
3. å¯¹è¯ç®¡ç†
4. æ–‡ä»¶æ§åˆ¶
5. **æœç´¢ä¸å¯å‘ç°æ€§** â­â­â­ (ç”Ÿå­˜çº¿)
6. **ä¼šè¯ç®¡ç†ï¼ˆå¼ºåˆ¶ç™»å‡ºï¼‰** â­â­â­ (ç”Ÿå­˜çº¿)
7. **å¹³å°éšç§ç­–ç•¥** â­
8. å†…å®¹æ²»ç†
9. **æ¨é€æ§åˆ¶** â­â­â­ (ç”Ÿå­˜çº¿)
10. **è¯ˆéª—/è™šå‡æ ‡è®°** â­
11. **æ¶ˆæ¯ç±»å‹æ§åˆ¶** â­
12. ç³»ç»Ÿå¼€å…³

**å¼ºçƒˆå»ºè®® (P1)**:
13. é‚€è¯·ç³»ç»Ÿ
14. æƒé™è¾¹ç•Œ
15. ç³»ç»Ÿæ¨é€
16. æ•°æ®ç»Ÿè®¡
17. **éªŒè¯æ ‡è®°** â­
18. **ç”¨æˆ·åç®¡ç†** â­

**å¯é€‰ (P2-P3)**:
19-25. è¿è¥æ‰©å±•å’Œé•¿æœŸè§„åˆ’

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… å®Œæˆ Echo Server éƒ¨ç½²
2. ğŸ”„ æ­å»º Echo Business Server æ¡†æ¶
3. ğŸ”„ å®ç° P0 æ ¸å¿ƒåŠŸèƒ½ï¼ˆå«æ¨é€æ§åˆ¶ï¼‰
4. â³ å®ç° P1 å·®å¼‚åŒ–åŠŸèƒ½
5. â³ æŒ‰éœ€å®ç° P2-P3 åŠŸèƒ½

---

**æœ€åæ›´æ–°**: 2026-01-27  
**çŠ¶æ€**: ç®¡ç†åå°åŠŸèƒ½è§„åˆ’å®Œæˆï¼ˆå«æ¨é€æ§åˆ¶å®Œæ•´è®¾è®¡ï¼‰

